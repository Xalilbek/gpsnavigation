(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){},137:function(e,t,a){},138:function(e,t,a){},316:function(e,t,a){},337:function(e,t,a){e.exports=a(737)},354:function(e,t,a){},358:function(e,t,a){},60:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},717:function(e,t,a){},735:function(e,t,a){},737:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(30),i=a.n(o),c=a(17),r=a(75),l=a(320),m=a(11),d={appLoader:!0,sidebarLoader:!1,mainLoader:!1,showSidebar:!0,settings:{}};var u={data:{},auth:!1,logout:!1};var p,h,f,b,g,v,E=Object(r.c)({globals:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;return"INIT_APP"===t.type?Object(m.a)({},e,{appLoader:!0}):"SET_APP_LOADER"===t.type?Object(m.a)({},e,{appLoader:t.value}):"SET_SIDEBAR_LOADER"===t.type?Object(m.a)({},e,{sidebarLoader:t.value}):"SET_MAIN_LOADER"===t.type?Object(m.a)({},e,{mainLoader:t.value}):"SHOW_SIDEBAR"===t.type?Object(m.a)({},e,{showSidebar:!0}):"HIDE_SIDEBAR"===t.type?Object(m.a)({},e,{showSidebar:!1}):"TOGGLE_SIDEBAR"===t.type?Object(m.a)({},e,{showSidebar:!e.showSidebar}):"SET_SETTINGS"===t.type?Object(m.a)({},e,{settings:t.value}):e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;return"SET_USER_DATA"===t.type?Object(m.a)({},e,{data:t.value,auth:!0}):"USER_LOGOUT"===t.type?{data:{},logout:!0,auth:!1}:e}}),y=Object(r.d)(E,Object(r.a)(l.a)),w=a(13),N=a.n(w),j=a(21),k=a(15),O=a(16),L={data:{},setData:function(e){this.data=e},getData:function(){return this.data},get:function(e){return this.data.lang_data&&"string"===typeof this.data.lang_data[e]?this.data.lang_data[e]:e}},S=a(31),x=a.n(S),C={settings:"/settings",translations:"/settings/translations",login:"/auth/signin",register:"/register","lostpassword.step1":"/auth/recoverstep1","lostpassword.step2":"/auth/recoverstep2","objects.add":"/objects/add","objects.list":"/objects/list","objects.listbygroup":"/objects/listbygroup","objects.info":"/objects/info","objects.edit":"/objects/edit","objects.delete":"/objects/delete","groups.add":"/objectgroups/add","groups.list":"/objectgroups/list","groups.info":"/objectgroups/info","groups.edit":"/objectgroups/edit","groups.delete":"/objectgroups/delete","data.objecttypes":"/data/objecttypes","data.countries":"/data/countries","data.icons":"/data/icons","account.info":"/account/info","account.update":"/account/update","account.password":"/account/password","account.verifyemail.step1":"/account/emailverifystep1","account.verifyemail.step2":"/account/emailverifystep2","geoobjects.add":"/geoobjects/add","geoobjects.list":"/geoobjects/list","geoobjects.info":"/geoobjects/info","geoobjects.edit":"/geoobjects/edit","geoobjects.delete":"/geoobjects/delete",history:"/history","history.routes":"/history/routes"},D={get:function(){var e=Object(j.a)(N.a.mark(function e(t,a){var n,s,o=arguments;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]&&o[2],s=o.length>3&&void 0!==o[3]&&o[3],C[t]){e.next=4;break}return e.abrupt("return",!1);case 4:return x.a.load("_token")&&-1===["register","translations"].indexOf(t)&&(a.token=x.a.load("_token")),a=Object(m.a)({},a,{lang:x.a.load("_lang")?x.a.load("_lang"):"ru",time:parseInt((new Date).getTime()/1e3,11)}),e.next=8,fetch("".concat("http://api.utigps.com"+C[t]+"?"+this.serializeQuery(a))).then(function(e){return e.json()}).then(n).catch(s);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),serializeQuery:function(e,t){var a=Object.keys(e).map(function(a){var n=e[a];return e.constructor===Array?a="".concat(t,"[]"):e.constructor===Object&&(a=t?"".concat(t,"[").concat(a,"]"):a),"object"===typeof n?D.serializeQuery(n,a):"".concat(a,"=").concat(encodeURIComponent(n))});return[].concat.apply([],a).join("&")}},T=a(56),M=(Object(T.a)(),a(20)),_=a(18),I=a(19),A=a(742),z=a(743),B=a(739),P=a(741),G=a(321),V=a.n(G),H=a(2),U=a.n(H),R=a(8),Y=a(738),F=(a(136),a(25)),W=a.n(F),Z=(a(137),a(138),W.a.mixin({toast:!0,position:"top-start",showConfirmButton:!1,timer:5e3})),X=function(e){function t(){var e;return Object(k.a)(this,t),(e=Object(M.a)(this,Object(_.a)(t).call(this))).toggleDropdown=function(){e.setState({showDropdown:!e.state.showDropdown})},e.selectLang=function(e){var t=new Date;t.setDate(t.getDate()+365),x.a.save("_lang",e,{path:"/",expires:t}),window.location.reload()},e.state={isLoading:!1,languages:[],currentLang:{}},e.showMenu=e.showMenu.bind(Object(R.a)(Object(R.a)(e))),e.hideMenu=e.hideMenu.bind(Object(R.a)(Object(R.a)(e))),e}return Object(I.a)(t,e),Object(O.a)(t,[{key:"showMenu",value:function(e){var t=this;e.preventDefault(),this.setState({showDropdown:!this.state.showDropdown},function(){document.addEventListener("click",t.hideMenu)})}},{key:"hideMenu",value:function(e){var t=this;this.dropdown&&!this.dropdown.contains(e.target)&&this.setState({showDropdown:!1},function(){document.removeEventListener("click",t.hideMenu)})}},{key:"componentDidMount",value:function(){var e=this;this.props.settings.langs.forEach(function(t){t.short_code===L.getData().lang&&e.setState(Object(m.a)({},e.state,{currentLang:t}))})}},{key:"submit",value:function(e){e.preventDefault();var t=this;this.props.dispatch;t.setState({isLoading:!0}),D.get("login",{email:t.refs.email.value,password:t.refs.password.value},function(e){if("success"===e.status){var a=new Date;a.setDate(a.getDate()+365),x.a.save("_token",e.token,{path:"/",expires:a}),window.location="/"}else t.setState({isLoading:!1}),Z({type:"error",title:e.description})},function(){t.setState({isLoading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.currentLang,n=t.showDropdown,o=this.props.settings;return s.a.createElement("div",{className:"AJVxkv"},s.a.createElement("div",{className:"qzuRfA"},s.a.createElement("div",{className:"mOqU7m"},s.a.createElement(Y.a,{to:"/",className:"item logo"},s.a.createElement("img",{src:"/assets/images/logo.png",alt:""})),s.a.createElement(Y.a,{to:"/about",className:"item"},L.get("About")),s.a.createElement(Y.a,{to:"/contact",className:"item"},L.get("Contact")),s.a.createElement(Y.a,{to:"/",className:"item"},L.get("Buy")),s.a.createElement("div",{className:"item"},s.a.createElement("div",{ref:function(t){return e.dropdown=t},className:U()("pJxH5U",{show:n})},s.a.createElement("span",{className:"text",onClick:this.showMenu},s.a.createElement("img",{className:"mr-2",src:"/assets/images/flags/".concat(a.short_code,".png"),alt:a.short_code}),a.title),s.a.createElement("div",{className:"menu"},o.langs.map(function(t,a){return s.a.createElement("div",{key:a,onClick:function(){return e.selectLang(t.short_code)},className:U()("item")},s.a.createElement("img",{src:"/assets/images/flags/".concat(t.short_code,".png"),alt:t.short_code})," ",t.title)})))))),s.a.createElement("div",{className:"PoSqNY no-gutters d-flex flex-nowrap flex-row"},s.a.createElement("div",{className:"SUe7NF col-6"},s.a.createElement("div",{className:"tabs-JLmNIa"},s.a.createElement(Y.a,{to:"/login",className:"item active"},L.get("SignIn")),s.a.createElement(Y.a,{to:"/register",className:"item"},L.get("SignUp"))),s.a.createElement("div",{className:"OdUT1T tS4Hbv"},s.a.createElement("h1",{className:"title"},L.get("SignIn")),s.a.createElement("form",{action:"",onSubmit:this.submit.bind(this)},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Email")),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"email",name:"email",className:"form-control"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Password")),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"password",name:"password",className:"form-control"})),s.a.createElement("div",{className:"form-row"},s.a.createElement("div",{className:"col"},s.a.createElement(Y.a,{to:"/lostpassword"},s.a.createElement("i",{className:"feather feather-lock"})," ",L.get("LostPassword"))),s.a.createElement("div",{className:"col-5"},s.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},L.get("BtnSignIn"))))))),s.a.createElement("div",{className:"SUe7NF cezL9I col-6"},s.a.createElement("div",{className:"DLeYWD"}),s.a.createElement("div",{className:"NsLhXs"},s.a.createElement("div",{className:"iDayUT"},"Online izl\u0259m\u0259 sistemi"),s.a.createElement("div",{className:"JDXDPs"},"Lorem Ipsum is simply dummy text of the printing and typesetting industry...")))),s.a.createElement("div",{className:"qzuRfA"},s.a.createElement("div",{className:"d-flex"},s.a.createElement("a",{className:"mr-3 ml-auto",href:""},s.a.createElement("img",{src:"/assets/images/as.png",alt:""})),s.a.createElement("a",{href:""},s.a.createElement("img",{src:"/assets/images/gp.png",alt:""})))))}}]),t}(s.a.Component),J=Object(c.b)(function(e){return{settings:e.globals.settings}},function(e){return{dispatch:e}})(X),q=W.a.mixin({toast:!0,position:"top-start",showConfirmButton:!1,timer:5e3}),Q=function(e){function t(){var e;return Object(k.a)(this,t),(e=Object(M.a)(this,Object(_.a)(t).call(this))).toggleDropdown=function(){e.setState({showDropdown:!e.state.showDropdown})},e.selectLang=function(e){var t=new Date;t.setDate(t.getDate()+365),x.a.save("_lang",e,{path:"/",expires:t}),window.location.reload()},e.state={isLoading:!1,countryList:[],country:-1,languages:[],currentLang:{}},e.showMenu=e.showMenu.bind(Object(R.a)(Object(R.a)(e))),e.hideMenu=e.hideMenu.bind(Object(R.a)(Object(R.a)(e))),e}return Object(I.a)(t,e),Object(O.a)(t,[{key:"showMenu",value:function(e){var t=this;e.preventDefault(),this.setState({showDropdown:!this.state.showDropdown},function(){document.addEventListener("click",t.hideMenu)})}},{key:"hideMenu",value:function(e){var t=this;this.dropdown&&!this.dropdown.contains(e.target)&&this.setState({showDropdown:!1},function(){document.removeEventListener("click",t.hideMenu)})}},{key:"getCountryList",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,D.get("data.countries",{},function(e){"success"===e.status&&t.setState({countryList:e.data})});case 3:return e.abrupt("return",t.state.countryList.length);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t=this;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.settings.langs.forEach(function(e){e.short_code===L.getData().lang&&t.setState(Object(m.a)({},t.state,{currentLang:e}))}),this.setState({isLoading:!0}),e.next=4,this.getCountryList();case 4:e.sent&&this.setState({isLoading:!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(e){e.preventDefault();var t=this;this.props.dispatch;t.setState({isLoading:!0}),D.get("register",{fullname:t.refs.fullname.value,email:t.refs.email.value,password:t.refs.password.value,country:t.refs.country.value},function(e){if("success"===e.status){var a=new Date;a.setDate(a.getDate()+365),x.a.save("_token",e.token,{path:"/",expires:a}),window.location="/"}else t.setState({isLoading:!1}),q({type:"error",title:e.description})},function(){t.setState({isLoading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.currentLang,n=t.showDropdown,o=this.props.settings;return s.a.createElement("div",{className:"AJVxkv"},s.a.createElement("div",{className:"qzuRfA"},s.a.createElement("div",{className:"mOqU7m"},s.a.createElement(Y.a,{to:"/",className:"item logo"},s.a.createElement("img",{src:"/assets/images/logo.png",alt:""})),s.a.createElement(Y.a,{to:"/about",className:"item"},L.get("About")),s.a.createElement(Y.a,{to:"/contact",className:"item"},L.get("Contact")),s.a.createElement(Y.a,{to:"/",className:"item"},L.get("Buy")),s.a.createElement("div",{className:"item"},s.a.createElement("div",{ref:function(t){return e.dropdown=t},className:U()("pJxH5U",{show:n})},s.a.createElement("span",{className:"text",onClick:this.showMenu},s.a.createElement("img",{className:"mr-2",src:"/assets/images/flags/".concat(a.short_code,".png"),alt:a.short_code}),a.title),s.a.createElement("div",{className:"menu"},o.langs.map(function(t,a){return s.a.createElement("div",{key:a,onClick:function(){return e.selectLang(t.short_code)},className:U()("item")},s.a.createElement("img",{src:"/assets/images/flags/".concat(t.short_code,".png"),alt:t.short_code})," ",t.title)})))))),s.a.createElement("div",{className:"PoSqNY no-gutters d-flex flex-nowrap flex-row"},s.a.createElement("div",{className:"SUe7NF col-6"},s.a.createElement("div",{className:"tabs-JLmNIa"},s.a.createElement(Y.a,{to:"/login",className:"item"},L.get("SignIn")),s.a.createElement(Y.a,{to:"/register",className:"item active"},L.get("SignUp"))),s.a.createElement("div",{className:"OdUT1T tS4Hbv"},s.a.createElement("h1",{className:"title"},L.get("SignUp")),s.a.createElement("form",{action:"",onSubmit:this.submit.bind(this)},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Fullname")),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"fullname",name:"fullname",className:"form-control"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Email")),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"email",name:"email",className:"form-control"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Password")),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"password",name:"password",className:"form-control"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Country")),s.a.createElement("select",{className:"form-control custom-select",ref:"country",value:this.state.country,onChange:function(t){return e.setState({country:t.target.value})}},s.a.createElement("option",{key:-1,value:""},"--"),this.state.countryList.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),s.a.createElement("div",{className:"form-row"},s.a.createElement("div",{className:"col-7"}),s.a.createElement("div",{className:"col-5"},s.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},L.get("BtnSignUp"))))))),s.a.createElement("div",{className:"SUe7NF cezL9I col-6"},s.a.createElement("div",{className:"DLeYWD"}),s.a.createElement("div",{className:"NsLhXs"},s.a.createElement("div",{className:"iDayUT"},"Online izl\u0259m\u0259 sistemi"),s.a.createElement("div",{className:"JDXDPs"},"Lorem Ipsum is simply dummy text of the printing and typesetting industry...")))),s.a.createElement("div",{className:"qzuRfA"},s.a.createElement("div",{className:"d-flex"},s.a.createElement("a",{className:"mr-3 ml-auto",href:""},s.a.createElement("img",{src:"/assets/images/as.png",alt:""})),s.a.createElement("a",{href:""},s.a.createElement("img",{src:"/assets/images/gp.png",alt:""})))))}}]),t}(s.a.Component),K=Object(c.b)(function(e){return{settings:e.globals.settings}},function(e){return{dispatch:e}})(Q),$=W.a.mixin({toast:!0,position:"top-start",showConfirmButton:!1,timer:5e3}),ee=function(e){function t(){var e;return Object(k.a)(this,t),(e=Object(M.a)(this,Object(_.a)(t).call(this))).toggleDropdown=function(){e.setState({showDropdown:!e.state.showDropdown})},e.selectLang=function(e){var t=new Date;t.setDate(t.getDate()+365),x.a.save("_lang",e,{path:"/",expires:t}),window.location.reload()},e.state={isLoading:!1,email:"",code:"",password:"",repassword:"",step:1,description:"",languages:[],currentLang:{}},e.showMenu=e.showMenu.bind(Object(R.a)(Object(R.a)(e))),e.hideMenu=e.hideMenu.bind(Object(R.a)(Object(R.a)(e))),e}return Object(I.a)(t,e),Object(O.a)(t,[{key:"showMenu",value:function(e){var t=this;e.preventDefault(),this.setState({showDropdown:!this.state.showDropdown},function(){document.addEventListener("click",t.hideMenu)})}},{key:"hideMenu",value:function(e){var t=this;this.dropdown&&!this.dropdown.contains(e.target)&&this.setState({showDropdown:!1},function(){document.removeEventListener("click",t.hideMenu)})}},{key:"componentDidMount",value:function(){var e=this;this.props.settings.langs.forEach(function(t){t.short_code===L.getData().lang&&e.setState(Object(m.a)({},e.state,{currentLang:t}))})}},{key:"submit",value:function(e){e.preventDefault();var t=this;this.props.dispatch;switch(this.state.step){case 1:t.setState({isLoading:!0}),D.get("lostpassword.step1",{email:t.refs.email.value},function(e){"success"===e.status?(t.setState({isLoading:!1,step:2}),$({type:"success",title:e.description})):(t.setState({isLoading:!1}),$({type:"error",title:e.description}))},function(){t.setState({isLoading:!1})});break;case 2:t.setState({isLoading:!0}),D.get("lostpassword.step2",{email:t.refs.email.value,code:t.refs.code.value,password:t.refs.password.value,repassword:t.refs.repassword.value},function(e){setTimeout(function(){"success"===e.status?(t.setState({isLoading:!1,step:3,description:e.description}),$({type:"success",title:e.description}),setTimeout(function(){window.location="/login"},2e3)):(t.setState({isLoading:!1}),$({type:"error",title:e.description}))},300)},function(){t.setState({isLoading:!1})})}}},{key:"render",value:function(){var e=this,t=this.state,a=(t.isLoading,t.step),n=t.email,o=t.code,i=t.password,c=t.repassword,r=t.description,l=t.currentLang,m=t.showDropdown,d=this.props.settings;return s.a.createElement("div",{className:"AJVxkv"},s.a.createElement("div",{className:"qzuRfA"},s.a.createElement("div",{className:"mOqU7m"},s.a.createElement(Y.a,{to:"/",className:"item logo"},s.a.createElement("img",{src:"/assets/images/logo.png",alt:""})),s.a.createElement(Y.a,{to:"/about",className:"item"},L.get("About")),s.a.createElement(Y.a,{to:"/contact",className:"item"},L.get("Contact")),s.a.createElement(Y.a,{to:"/",className:"item"},L.get("Buy")),s.a.createElement("div",{className:"item"},s.a.createElement("div",{ref:function(t){return e.dropdown=t},className:U()("pJxH5U",{show:m})},s.a.createElement("span",{className:"text",onClick:this.showMenu},s.a.createElement("img",{className:"mr-2",src:"/assets/images/flags/".concat(l.short_code,".png"),alt:l.short_code}),l.title),s.a.createElement("div",{className:"menu"},d.langs.map(function(t,a){return s.a.createElement("div",{key:a,onClick:function(){return e.selectLang(t.short_code)},className:U()("item")},s.a.createElement("img",{src:"/assets/images/flags/".concat(t.short_code,".png"),alt:t.short_code})," ",t.title)})))))),s.a.createElement("div",{className:"PoSqNY no-gutters d-flex flex-nowrap flex-row"},s.a.createElement("div",{className:"SUe7NF col-6"},s.a.createElement("div",{className:"tabs-JLmNIa"},s.a.createElement(Y.a,{to:"/login",className:"item active"},L.get("SignIn")),s.a.createElement(Y.a,{to:"/register",className:"item"},L.get("SignUp"))),s.a.createElement("div",{className:"OdUT1T"},s.a.createElement("h1",{className:"title"},L.get("LostPassword")),1===a?s.a.createElement("form",{action:"",onSubmit:this.submit.bind(this)},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("EnterEmail")),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"email",name:"email",value:n,onChange:function(t){return e.setState({email:t.target.value})},className:"form-control"})),s.a.createElement("div",{className:"form-row"},s.a.createElement("div",{className:"col-7"}),s.a.createElement("div",{className:"col-5"},s.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},L.get("Confirm"))))):2===a?s.a.createElement("form",{action:"",method:"post",onSubmit:this.submit.bind(this)},s.a.createElement("input",{ref:"email",type:"hidden",name:"email",value:n}),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("ConfirmationCode"),":"),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"code",name:"code",value:o,onChange:function(t){return e.setState({code:t.target.value})},className:"form-control"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("NewPassword"),":"),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"password",name:"password",value:i,onChange:function(t){return e.setState({password:t.target.value})},className:"form-control"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("NewPassword2"),":"),s.a.createElement("input",{autoComplete:"off",type:"text",ref:"repassword",name:"repassword",value:c,onChange:function(t){return e.setState({repassword:t.target.value})},className:"form-control"})),s.a.createElement("div",{className:"form-row"},s.a.createElement("div",{className:"col-7"}),s.a.createElement("div",{className:"col-5"},s.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},L.get("Confirm"))))):s.a.createElement("h6",null,r))),s.a.createElement("div",{className:"SUe7NF col-6"},s.a.createElement("div",{className:"DLeYWD"}),s.a.createElement("div",{className:"NsLhXs"},s.a.createElement("div",{className:"iDayUT"},"Online izl\u0259m\u0259 sistemi"),s.a.createElement("div",{className:"JDXDPs"},"Lorem Ipsum is simply dummy text of the printing and typesetting industry...")))),s.a.createElement("div",{className:"qzuRfA"},s.a.createElement("div",{className:"d-flex"},s.a.createElement("a",{className:"mr-3 ml-auto",href:""},s.a.createElement("img",{src:"/assets/images/as.png",alt:""})),s.a.createElement("a",{href:""},s.a.createElement("img",{src:"/assets/images/gp.png",alt:""})))))}}]),t}(s.a.Component),te=Object(c.b)(function(e){return{settings:e.globals.settings}},function(e){return{dispatch:e}})(ee),ae=a(740),ne=a(133),se=(a(354),function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).toggleDropdown=function(){a.setState({showDropdown:!a.state.showDropdown})},a.selectLang=function(e){var t=new Date;t.setDate(t.getDate()+365),x.a.save("_lang",e,{path:"/",expires:t}),window.location.reload()},document.title=e.title?e.title:L.get("Title"),a.state={languages:[],showDropdown:!1,currentLang:{}},a.showMenu=a.showMenu.bind(Object(R.a)(Object(R.a)(a))),a.hideMenu=a.hideMenu.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"showMenu",value:function(e){var t=this;e.preventDefault(),this.setState({showDropdown:!this.state.showDropdown},function(){document.addEventListener("click",t.hideMenu)})}},{key:"hideMenu",value:function(e){var t=this;this.dropdown&&!this.dropdown.contains(e.target)&&this.setState({showDropdown:!1},function(){document.removeEventListener("click",t.hideMenu)})}},{key:"componentDidMount",value:function(){var e=this;this.props.settings.langs.forEach(function(t){t.short_code===L.getData().lang&&e.setState(Object(m.a)({},e.state,{currentLang:t}))})}},{key:"render",value:function(){var e=this,t=this.props,a=(t.title,t.controller),n=t.user,o=t.settings,i=this.state,c=i.currentLang,r=i.showDropdown;return s.a.createElement("div",{className:"header"},s.a.createElement("div",{className:"navbar-IgfQ1Z"},s.a.createElement("div",{className:"item auto VmIRki"},s.a.createElement(Y.a,{to:"/",className:"link"},s.a.createElement("svg",{className:"icon"},s.a.createElement("use",{xlinkHref:"#map-pin"})),s.a.createElement("span",null,"Uti",s.a.createElement("font",{color:"#d6ff36"},"Gps")))),s.a.createElement("div",{className:"item space"}),s.a.createElement("div",{className:"item auto"},s.a.createElement(Y.a,{to:"/",className:U()("link",{active:"objects"===a})},s.a.createElement("svg",{className:"icon"},s.a.createElement("use",{xlinkHref:"#objects"})),s.a.createElement("span",null,L.get("Objects")))),s.a.createElement("div",{className:"item auto"},s.a.createElement(Y.a,{to:"/tracks",className:U()("link",{active:"tracks"===a})},s.a.createElement("svg",{className:"icon"},s.a.createElement("use",{xlinkHref:"#tracks"})),s.a.createElement("span",null,L.get("Tracks")))),s.a.createElement("div",{className:"item auto"},s.a.createElement(Y.a,{to:"/geo-objects",className:U()("link",{active:"geoobjects"===a})},s.a.createElement("svg",{className:"icon"},s.a.createElement("use",{xlinkHref:"#location"})),s.a.createElement("span",null,L.get("GeoObjects")))),s.a.createElement("div",{className:"item space"}),s.a.createElement("div",{className:"item auto"},s.a.createElement("div",{ref:function(t){return e.dropdown=t},className:U()("dropdown-TdgQEA col-auto",{show:r})},s.a.createElement("span",{className:"text-TdgQEA",onClick:this.showMenu},s.a.createElement("img",{className:"mr-2",src:"/assets/images/flags/".concat(c.short_code,".png"),alt:c.short_code}),c.title,s.a.createElement("i",{className:"feather feather-chevron-".concat(r?"up":"down")})),s.a.createElement("div",{className:"menu-TdgQEA"},o.langs.map(function(t,a){return s.a.createElement("div",{key:a,onClick:function(){return e.selectLang(t.short_code)},className:U()("item")},s.a.createElement("img",{src:"/assets/images/flags/".concat(t.short_code,".png"),alt:t.short_code})," ",t.title)})))),s.a.createElement("div",{className:"item auto"},s.a.createElement(Y.a,{to:"/account",className:U()("link",{active:"account"===a})},s.a.createElement("svg",{className:"icon"},s.a.createElement("use",{xlinkHref:"#user"})),s.a.createElement("span",null,n.data.email)))))}}]),t}(s.a.Component)),oe=Object(c.b)(function(e){return{user:e.user,settings:e.globals.settings}},function(e){return{dispatch:e}})(se),ie=(a(60),a(66),function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"toggleSidebar",value:function(){this.props.dispatch({type:"TOGGLE_SIDEBAR"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.isLoading,o=t.status;return s.a.createElement("div",{className:"sidebar"},n?s.a.createElement("div",{className:"loader-jcNItk-container"},s.a.createElement("div",{className:"loader-qrjiL2"},s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null))):a,s.a.createElement("span",{className:"btn-toggler",onClick:function(){return e.toggleSidebar()}},s.a.createElement("i",{className:"feather feather-chevrons-".concat(o?"left":"right")})))}}]),t}(s.a.Component)),ce=(Object(c.b)(function(e){return{isLoading:e.globals.sidebarLoader,status:e.globals.showSidebar}},function(e){return{dispatch:e}})(ie),a(358),function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"hideSidebar",value:function(){this.props.dispatch({type:"HIDE_SIDEBAR"})}},{key:"render",value:function(){return s.a.createElement("div",null)}}]),t}(s.a.Component)),re=(Object(c.b)(function(e){return{showSidebar:e.globals.showSidebar}},function(e){return{dispatch:e}})(ce),a(33)),le=(a(77),W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3}),function(e){function t(e){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).call(this,e))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isLoading,a=e.items,n=e.onEdit,o=e.onDelete,i=e.onView;return t?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})):s.a.createElement("div",{className:"list visible CbSvVN"},!!a.length&&a.map(function(e,t){return s.a.createElement("div",{key:t,className:"item"},s.a.createElement("div",{className:"col-auto watch text cursor-pointer"},s.a.createElement("i",{className:"feather feather-".concat("polygon"===e.type?"share-2":"point"===e.type?"share-2":"circle")})),s.a.createElement("span",{className:"col label text text-truncate cursor-pointer",onClick:function(){return i(e)}},e.title),s.a.createElement("span",{className:"col-auto d-flex align-items-center"},s.a.createElement(re.Dropdown,{style:{right:"5px"},menuStyle:{minWidth:"150px"},placement:"bottomRight",renderTitle:function(){return s.a.createElement("span",{className:"button cursor-pointer"},s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"},s.a.createElement("circle",{cx:"12",cy:"12",r:"1"}),s.a.createElement("circle",{cx:"12",cy:"5",r:"1"}),s.a.createElement("circle",{cx:"12",cy:"19",r:"1"})))}},s.a.createElement(re.Dropdown.Item,{onSelect:function(){return n(e)}},s.a.createElement("i",{className:"feather feather-edit-2 mr-2"}),L.get("Edit")),s.a.createElement(re.Dropdown.Item,{onSelect:function(){return o(e.id)}},s.a.createElement("i",{className:"feather feather-trash mr-2"}),L.get("Delete")))))}))}}]),t}(s.a.Component)),me=Object(c.b)(function(e){return{}},function(e){return{dispatch:e}})(le),de=a(12),ue=a.n(de),pe=(a(107),a(46)),he=a.n(pe),fe=(a(64),a(65),a(108),a(109),a(110),W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3})),be=[40.37937457190185,49.848964512348175];window.navigator&&window.navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){be=[e.coords.latitude,e.coords.longitude]});var ge={zoomControl:!0,zoom:16,maxZoom:25,minZoom:2,doubleClickZoom:!0,scrollWheelZoom:!0,dragging:!0,editable:!0,animate:!0,legends:!0,infoControl:!0,easeLinearity:10,attributionControl:!0};ue.a.drawLocal={draw:Object(m.a)({},ue.a.drawLocal.draw,{toolbar:Object(m.a)({},ue.a.drawLocal.draw.toolbar,{actions:!1,finish:!1,undo:!1,buttons:!1})}),edit:Object(m.a)({},ue.a.drawLocal.edit,{toolbar:Object(m.a)({},ue.a.drawLocal.edit.toolbar,{actions:Object(m.a)({},ue.a.drawLocal.edit.toolbar.actions,{save:{title:L.get("Save"),text:L.get("Save")},cancel:{title:L.get("Cancel"),text:L.get("Cancel")},clearAll:{title:L.get("ClearAll"),text:L.get("ClearAll")}}),buttons:{edit:L.get("EditLayers"),editDisabled:!1,remove:L.get("DeleteLayers"),removeDisabled:!1}}),handlers:{edit:{tooltip:!1},remove:{tooltip:!1}}})};var ve,Ee,ye,we,Ne,je=function(e){function t(e){var a;return Object(k.a)(this,t),p=!1,(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).disableActions=function(e){h.disable(),f.disable()},a.submit=function(e){e.preventDefault();var t=Object(R.a)(Object(R.a)(a)),n=t.state,s=n.id,o=n.data,i=n.action,c=n.layerType,r=g.getLayers()[0],l=0,d={};if("undefined"===typeof r)return!1;switch(i){case"add":switch(c){case"polygon":r.getLatLngs()[0].map(function(e,t){d[t]={0:e.lat,1:e.lng}});break;case"circle":var u=r.getLatLng(),h=u.lat,f=u.lng;d={0:h,1:f},l=r.getRadius()}break;case"edit":switch(c){case"polygon":r.getLatLngs()[0].map(function(e,t){d[t]={0:e.lat,1:e.lng}});break;case"circle":var b=r.getLatLng();h=b.lat,f=b.lng;d={0:h,1:f},l=r.getRadius()}}D.get("geoobjects.".concat("add"===i?"add":"edit"),{type:c,title:o.title,coordinates:d,radius:l,id:s},function(){var e=Object(j.a)(N.a.mark(function e(a){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({items:[],data:Object(m.a)({},t.state.data,{title:o.title,type:"polygon",coordinates:d,radius:l})}),e.next=3,t.onLoad();case 3:e.sent&&("success"===a.status?fe({type:"success",title:a.description}):fe({type:"error",title:a.description}),p.fitBounds(r.getBounds()));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())},a.state={isLoading:!1,items:[],polygon:null,circle:null,geoJson:null,layerType:"polygon",layers:[],center:[40.37937457190185,49.848964512348175],zoom:16,radius:0,coordinates:[],modal:{show:!1,style:{},size:{width:300,height:"auto",x:40,y:104}},action:"add",id:0,data:{type:"polygon",title:""}},a.setLayerType=a.setLayerType.bind(Object(R.a)(Object(R.a)(a))),a.addZone=a.addZone.bind(Object(R.a)(Object(R.a)(a))),a.showModal=a.showModal.bind(Object(R.a)(Object(R.a)(a))),a.hideModal=a.hideModal.bind(Object(R.a)(Object(R.a)(a))),a.submit=a.submit.bind(Object(R.a)(Object(R.a)(a))),a.onView=a.onView.bind(Object(R.a)(Object(R.a)(a))),a.onDelete=a.onDelete.bind(Object(R.a)(Object(R.a)(a))),a.onEdit=a.onEdit.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"initialize",value:function(){var e=this.state,t=e.center,a=e.zoom;p=ue.a.map("map",ge).setView(t,a),ue.a.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(p),g=new ue.a.FeatureGroup,p.addLayer(g),h=new ue.a.Draw.Polygon(p),f=new ue.a.Draw.Circle(p),v=new ue.a.FeatureGroup,b=new ue.a.Control.Draw({position:"topleft",draw:!1,edit:{featureGroup:g,remove:!0}}),p.addControl(b)}},{key:"componentDidMount",value:function(){var e=this;p||this.initialize(),this.onLoad(),p.on(ue.a.Draw.Event.CREATED,function(t){var a=t.layerType,n=t.layer,s=n.toGeoJSON();switch(e.createLayer(n),e.setState({geoJson:s}),a){case"polygon":var o=n.getLatLngs();e.setState({coordinates:o});break;case"circle":var i=n.getRadius();e.setState({radius:i})}}),p.on(ue.a.Draw.Event.DELETED,function(t){t.layers.eachLayer(function(e){p.removeLayer(e)}),t.layers.getLayers().length&&("polygon"===e.state.layerType?h.enable():"circle"===e.state.layerType&&f.enable())}),he()(window).on("resize",function(){setTimeout(function(){p.invalidateSize()},100)})}},{key:"inArray",value:function(e,t){return t.find(function(t){return t===e})}},{key:"addZone",value:function(){this.hideModal(),this.showModal(function(e){e.removeLayers(),e.setState({layerType:"polygon",center:be,zoom:16}),e.disableActions(e),h.enable()})}},{key:"showModal",value:function(e){this.setState({modal:Object(m.a)({},this.state.modal,{show:!0,data:{type:"polygon",title:""},size:{width:300,height:"auto",x:40,y:104}})}),e&&e(this)}},{key:"hideModal",value:function(e){this.removeLayers(),this.setState(Object(m.a)({},this.state,{action:"add",layers:[],data:{type:"polygon",title:""},modal:Object(m.a)({},this.state.modal,{show:!1})})),e&&e(this)}},{key:"toggleSidebar",value:function(){this.props.dispatch({type:"TOGGLE_SIDEBAR"}),setTimeout(function(){p.invalidateSize()},200)}},{key:"setLayerType",value:function(e,t){this.setState({layerType:e}),"edit"===this.state.action?this.state.layers.forEach(function(e){g.removeLayer(e)}):this.removeLayers(),t&&t(this),"polygon"===e?h.enable():f.enable()}},{key:"createLayer",value:function(e){var t=this.state.layers;t.push(e),this.setState({layers:t}),g.addLayer(e),p.addLayer(e)}},{key:"removeLayer",value:function(e){var t=this.state.layers;this.inArray(e,t)&&delete t[t.indexOf(e)],this.setState({layers:t}),g.removeLayer(e),p.removeLayer(e)}},{key:"removeLayers",value:function(){this.state.layers.forEach(function(e){g.removeLayer(e),p.removeLayer(e)}),this.setState({layers:[]}),v.clearLayers()}},{key:"onView",value:function(e){switch(this.setState({layerType:e.type,action:"edit",id:e.id,data:e}),this.removeLayers(),e.type){case"polygon":var t=new ue.a.polygon(e.coordinates).addTo(p),a=t.getBounds().getCenter();v.addLayer(t).addTo(p),this.setState({center:[a.lat,a.lng]}),p.fitBounds(v.getBounds());break;case"circle":var n=new ue.a.circle(e.coordinates,e.radius).addTo(p);a=n.getBounds().getCenter();v.addLayer(n).addTo(p),this.setState({center:[a.lat,a.lng]}),p.fitBounds(v.getBounds())}}},{key:"onLoad",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this).setState({isLoading:!0}),e.next=4,D.get("geoobjects.list",{limit:0,type:"polygon"},function(e){"success"===e.status?t.setState({isLoading:!1,items:e.data}):t.setState({isLoading:!1})});case 4:return e.abrupt("return",t.state.items);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onDelete",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W()({title:L.get("DeleteAlertTitle"),text:L.get("DeleteAlertDescription"),type:"error",buttonsStyling:!1,showCancelButton:!0,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-secondary",confirmButtonText:L.get("YesDeleteIt"),cancelButtonText:L.get("Cancel")});case 2:(a=e.sent)&&a.value&&((n=this).setState({isLoading:!0,items:[]}),D.get("geoobjects.delete",{id:t},function(e){"success"===e.status?(n.setState({isLoading:!1}),fe({type:"success",title:e.description}),n.onLoad()):(n.setState({isLoading:!1}),fe({type:"error",title:e.description}))}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onEdit",value:function(e){switch(this.setState({layerType:e.type,action:"edit",id:e.id,data:e}),this.showModal(),this.removeLayers(),e.type){case"polygon":var t=new ue.a.polygon(e.coordinates).addTo(p),a=t.getBounds().getCenter();this.createLayer(t),this.setState({center:[a.lat,a.lng]}),t.editing.enable(),p.fitBounds(t.getBounds());break;case"circle":var n=new ue.a.circle(e.coordinates,e.radius).addTo(p);a=n.getBounds().getCenter();this.createLayer(n),this.setState({center:[a.lat,a.lng]}),n.editing.enable(),p.fitBounds(n.getBounds())}}},{key:"render",value:function(){var e=this,t=this.state.isLoading,a=this.props,n=a.sidebar;a.toggleSidebar;return s.a.createElement("div",{className:U()("app-container",{"show-sidebar":n.show})},s.a.createElement(oe,{title:L.get("GeoObjects"),controller:"geoobjects"}),s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"sidebar-wrapper"},s.a.createElement("div",{className:"sidebar-header"},s.a.createElement("ul",{className:"tabs justified flex-nowrap"},s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/geo-objects",className:"link col"},s.a.createElement("i",{className:"icon feather feather-share-2"}),s.a.createElement("span",{className:"text"},L.get("GeoZones"))),s.a.createElement("span",{className:"link col-auto py-0",onClick:function(){return e.addZone()}},s.a.createElement("i",{className:"feather feather-plus fs-20"}))),s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/geo-objects/points",className:"link col"},s.a.createElement("i",{className:"icon feather feather-map-pin"}),s.a.createElement("span",{className:"text"},L.get("GeoPoints")))))),s.a.createElement("div",{className:"sidebar-body"},n.loader?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})):s.a.createElement(me,{isLoading:t,items:this.state.items,onEdit:this.onEdit,onDelete:this.onDelete,onView:this.onView}))),s.a.createElement("span",{className:"btn-toggler",onClick:function(){return e.toggleSidebar()}},s.a.createElement("i",{className:"feather feather-chevrons-".concat(n.show?"left":"right")}))),s.a.createElement("div",{className:"main"},!!t&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"calc(100vh - 60px)",zIndex:999}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{style:{height:"100%",width:"100%",position:"relative",overflow:"hidden"}},s.a.createElement("div",{id:"map"}))),!!this.state.modal.show&&s.a.createElement(ne.a,{className:"rnd-modal",style:this.state.modal.style,bounds:"body",enableUserSelectHack:!1,size:{width:this.state.modal.size.width,height:this.state.modal.size.height},position:{x:this.state.modal.size.x,y:this.state.modal.size.y},onDragStop:function(t,a){return e.setState({modal:Object(m.a)({},e.state.modal,{size:Object(m.a)({},e.state.modal.size,{x:a.x,y:a.y})})})},onResize:function(t,a,n,s,o){return e.setState({modal:Object(m.a)({},e.state.modal,{size:Object(m.a)({width:n.style.width,height:n.style.height},o)})})}},s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("AddGeoZone")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal(function(t){t.setState({layerType:"polygon",center:be,zoom:16}),e.disableActions(t)})}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},s.a.createElement("div",{className:"btn-group btn-group-sm btn-block mb-2"},s.a.createElement("button",{className:U()("btn w-50 btn-outline-success",{active:"polygon"===this.state.layerType}),onClick:function(){return e.setLayerType("polygon",e.disableActions)}},L.get("Polygon")),s.a.createElement("button",{className:U()("btn w-50 btn-outline-success",{active:"circle"===this.state.layerType}),onClick:function(){return e.setLayerType("circle",e.disableActions)}},L.get("Circle"))),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("label",null,L.get("Title")),s.a.createElement("input",{type:"text",ref:"title",className:"form-control",value:this.state.data.title,onChange:function(t){return e.setState(Object(m.a)({},e.state,{data:Object(m.a)({},e.state.data,{title:t.target.value})}))}}))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:this.submit},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal(function(t){t.setState({layerType:"polygon"}),e.disableActions(t)})}},L.get("Cancel")))))}}]),t}(s.a.Component),ke=Object(c.b)(function(e){return{sidebar:{show:e.globals.showSidebar,loader:e.globals.sidebarLoader},mainLoader:e.globals.mainLoader}},function(e){return{dispatch:e}})(je),Oe=W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3}),Le=[40.37937457190185,49.848964512348175];window.navigator&&window.navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){Le=[e.coords.latitude,e.coords.longitude]});var Se={zoomControl:!0,zoom:9,maxZoom:18,minZoom:2,doubleClickZoom:!0,scrollWheelZoom:!0,dragging:!0,editable:!0,animate:!0,legends:!0,infoControl:!0,easeLinearity:10,attributionControl:!0};ue.a.drawLocal={draw:Object(m.a)({},ue.a.drawLocal.draw,{toolbar:Object(m.a)({},ue.a.drawLocal.draw.toolbar,{actions:!1,finish:!1,undo:!1,buttons:!1})}),edit:Object(m.a)({},ue.a.drawLocal.edit,{toolbar:Object(m.a)({},ue.a.drawLocal.edit.toolbar,{actions:Object(m.a)({},ue.a.drawLocal.edit.toolbar.actions,{save:{title:L.get("Save"),text:L.get("Save")},cancel:{title:L.get("Cancel"),text:L.get("Cancel")},clearAll:{title:L.get("ClearAll"),text:L.get("ClearAll")}}),buttons:{edit:L.get("EditLayers"),editDisabled:!1,remove:L.get("DeleteLayers"),removeDisabled:!1}}),handlers:{edit:{tooltip:!1},remove:{tooltip:!1}}})};var xe=function(e){function t(e){var a;return Object(k.a)(this,t),ve=!1,(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).disableActions=function(e){Ee.disable()},a.submit=function(e){e.preventDefault();var t=Object(R.a)(Object(R.a)(a)),n=t.state,s=n.id,o=n.data,i=n.action,c=n.layerType,r=we.getLayers()[0],l={};if("undefined"===typeof r)return!1;switch(i){case"add":switch(c){case"marker":var d=r.getLatLng(),u=d.lat,p=d.lng;l={0:u,1:p}}break;case"edit":switch(c){case"marker":var h=r.getLatLng();u=h.lat,p=h.lng;l={0:u,1:p}}}D.get("geoobjects.".concat("add"===i?"add":"edit"),{type:"point",title:o.title,coordinates:l,radius:0,id:s},function(){var e=Object(j.a)(N.a.mark(function e(a){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({items:[],data:Object(m.a)({},t.state.data,{title:o.title,type:"point",coordinates:l,radius:0})}),e.next=3,t.onLoad();case 3:e.sent&&("success"===a.status?Oe({type:"success",title:a.description}):Oe({type:"error",title:a.description}),ve.fitBounds(we.getBounds()));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())},a.state={isLoading:!1,items:[],polygon:null,circle:null,geoJson:null,layerType:"marker",layers:[],center:[40.37937457190185,49.848964512348175],zoom:9,radius:0,coordinates:[],modal:{show:!1,style:{},size:{width:300,height:"auto",x:40,y:104}},action:"add",id:0,data:{type:"point",title:""}},a.setLayerType=a.setLayerType.bind(Object(R.a)(Object(R.a)(a))),a.addZone=a.addZone.bind(Object(R.a)(Object(R.a)(a))),a.showModal=a.showModal.bind(Object(R.a)(Object(R.a)(a))),a.hideModal=a.hideModal.bind(Object(R.a)(Object(R.a)(a))),a.submit=a.submit.bind(Object(R.a)(Object(R.a)(a))),a.onView=a.onView.bind(Object(R.a)(Object(R.a)(a))),a.onDelete=a.onDelete.bind(Object(R.a)(Object(R.a)(a))),a.onEdit=a.onEdit.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"initialize",value:function(){var e=this.state,t=e.center,a=e.zoom;ve=ue.a.map("map",Se).setView(t,a),ue.a.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(ve),we=new ue.a.FeatureGroup,ve.addLayer(we),Ee=new ue.a.Draw.Marker(ve,{icon:ue.a.icon({iconUrl:"/assets/images/marker.svg",iconSize:[24,41],iconAnchor:[12,40]})}),Ne=new ue.a.FeatureGroup,ye=new ue.a.Control.Draw({position:"topleft",draw:!1,edit:{featureGroup:we,remove:!0}}),ve.addControl(ye)}},{key:"componentDidMount",value:function(){var e=this;ve||this.initialize(),this.onLoad(),ve.on(ue.a.Draw.Event.CREATED,function(t){var a=t.layerType,n=t.layer,s=n.toGeoJSON();switch(e.createLayer(n),e.setState({geoJson:s}),a){case"marker":var o=n.getLatLng();e.setState({coordinates:o})}}),ve.on(ue.a.Draw.Event.DELETED,function(t){t.layers.eachLayer(function(e){ve.removeLayer(e)}),t.layers.getLayers().length&&"marker"===e.state.layerType&&Ee.enable()}),he()(window).on("resize",function(){setTimeout(function(){ve.invalidateSize()},100)})}},{key:"inArray",value:function(e,t){return t.find(function(t){return t===e})}},{key:"addZone",value:function(){this.hideModal(),this.showModal(function(e){e.removeLayers(),e.setState({layerType:"marker",center:Le,zoom:9}),e.disableActions(e),Ee.enable()})}},{key:"showModal",value:function(e){this.setState({modal:Object(m.a)({},this.state.modal,{show:!0,data:{type:"point",title:""},size:{width:300,height:"auto",x:40,y:104}})}),e&&e(this)}},{key:"hideModal",value:function(e){this.removeLayers(),this.setState(Object(m.a)({},this.state,{action:"add",layers:[],data:{type:"point",title:""},modal:Object(m.a)({},this.state.modal,{show:!1})})),e&&e(this)}},{key:"toggleSidebar",value:function(){this.props.dispatch({type:"TOGGLE_SIDEBAR"}),setTimeout(function(){ve.invalidateSize()},200)}},{key:"setLayerType",value:function(e,t){this.setState({layerType:e}),"edit"===this.state.action?this.state.layers.forEach(function(e){we.removeLayer(e)}):this.removeLayers(),t&&t(this),Ee.enable()}},{key:"createLayer",value:function(e){var t=this.state.layers;t.push(e),this.setState({layers:t}),we.addLayer(e),ve.addLayer(e)}},{key:"removeLayer",value:function(e){var t=this.state.layers;this.inArray(e,t)&&delete t[t.indexOf(e)],this.setState({layers:t}),we.removeLayer(e),ve.removeLayer(e)}},{key:"removeLayers",value:function(){this.state.layers.forEach(function(e){we.removeLayer(e),ve.removeLayer(e)}),this.setState({layers:[]}),Ne.clearLayers()}},{key:"onView",value:function(e){switch(this.setState({layerType:"marker",action:"edit",id:e.id,data:e}),this.removeLayers(),e.type){case"point":var t={icon:ue.a.icon({iconUrl:"/assets/images/marker.svg",iconSize:[24,41],iconAnchor:[12,40]})},a=new ue.a.marker(e.coordinates,t).addTo(ve);Ne.addLayer(a).addTo(ve),this.setState({center:e.coordinates}),ve.fitBounds(Ne.getBounds())}}},{key:"onLoad",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this).setState({isLoading:!0}),e.next=4,D.get("geoobjects.list",{limit:0,type:"point"},function(e){"success"===e.status?t.setState({isLoading:!1,items:e.data}):t.setState({isLoading:!1})});case 4:return e.abrupt("return",t.state.items);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onDelete",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W()({title:L.get("DeleteAlertTitle"),text:L.get("DeleteAlertDescription"),type:"error",buttonsStyling:!1,showCancelButton:!0,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-secondary",confirmButtonText:L.get("YesDeleteIt"),cancelButtonText:L.get("Cancel")});case 2:(a=e.sent)&&a.value&&((n=this).setState({isLoading:!0,items:[]}),D.get("geoobjects.delete",{id:t},function(e){"success"===e.status?(n.setState({isLoading:!1}),Oe({type:"success",title:e.description}),n.onLoad()):(n.setState({isLoading:!1}),Oe({type:"error",title:e.description}))}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onEdit",value:function(e){switch(this.setState({layerType:"marker",action:"edit",id:e.id,data:e}),this.showModal(),this.removeLayers(),e.type){case"point":var t={icon:ue.a.icon({iconUrl:"/assets/images/marker.svg",iconSize:[24,41],iconAnchor:[12,40]})},a=new ue.a.marker(e.coordinates,t).addTo(ve),n=ue.a.featureGroup([a]).addTo(ve);this.createLayer(a),this.setState({center:e.coordinates}),a.editing.enable(),ve.fitBounds(n.getBounds())}}},{key:"render",value:function(){var e=this,t=this.state.isLoading,a=this.props,n=a.sidebar;a.toggleSidebar;return s.a.createElement("div",{className:U()("app-container",{"show-sidebar":n.show})},s.a.createElement(oe,{title:L.get("GeoObjects"),controller:"geoobjects"}),s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"sidebar-wrapper"},s.a.createElement("div",{className:"sidebar-header"},s.a.createElement("ul",{className:"tabs justified flex-nowrap"},s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/geo-objects",className:"link col"},s.a.createElement("i",{className:"icon feather feather-share-2"}),s.a.createElement("span",{className:"text"},L.get("GeoZones")))),s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/geo-objects/points",className:"link col"},s.a.createElement("i",{className:"icon feather feather-map-pin"}),s.a.createElement("span",{className:"text"},L.get("GeoPoints"))),s.a.createElement("span",{className:"link col-auto py-0",onClick:function(){return e.addZone()}},s.a.createElement("i",{className:"feather feather-plus fs-20"}))))),s.a.createElement("div",{className:"sidebar-body"},n.loader?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})):s.a.createElement(me,{isLoading:t,items:this.state.items,onEdit:this.onEdit,onDelete:this.onDelete,onView:this.onView}))),s.a.createElement("span",{className:"btn-toggler",onClick:function(){return e.toggleSidebar()}},s.a.createElement("i",{className:"feather feather-chevrons-".concat(n.show?"left":"right")}))),s.a.createElement("div",{className:"main"},!!t&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"calc(100vh - 60px)",zIndex:999}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{style:{height:"100%",width:"100%",position:"relative",overflow:"hidden"}},s.a.createElement("div",{id:"map"}))),!!this.state.modal.show&&s.a.createElement(ne.a,{className:"rnd-modal",style:this.state.modal.style,bounds:"body",enableUserSelectHack:!1,size:{width:this.state.modal.size.width,height:this.state.modal.size.height},position:{x:this.state.modal.size.x,y:this.state.modal.size.y},onDragStop:function(t,a){return e.setState({modal:Object(m.a)({},e.state.modal,{size:Object(m.a)({},e.state.modal.size,{x:a.x,y:a.y})})})},onResize:function(t,a,n,s,o){return e.setState({modal:Object(m.a)({},e.state.modal,{size:Object(m.a)({width:n.style.width,height:n.style.height},o)})})}},s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("AddGeoZone")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal(function(t){t.setState({layerType:"marker",center:Le,zoom:9}),e.disableActions(t)})}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("label",null,L.get("Title")),s.a.createElement("input",{type:"text",ref:"title",className:"form-control",value:this.state.data.title,onChange:function(t){return e.setState(Object(m.a)({},e.state,{data:Object(m.a)({},e.state.data,{title:t.target.value})}))}}))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:this.submit},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal(function(t){t.setState({layerType:"marker"}),e.disableActions(t)})}},L.get("Cancel")))))}}]),t}(s.a.Component),Ce=Object(c.b)(function(e){return{sidebar:{show:e.globals.showSidebar,loader:e.globals.sidebarLoader},mainLoader:e.globals.mainLoader}},function(e){return{dispatch:e}})(xe),De=function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"SET_HEADER_ACTIVE_LINK_ID",value:"geoobjects"})}},{key:"render",value:function(){return s.a.createElement(z.a,null,s.a.createElement(B.a,{exact:!0,path:"/geo-objects",component:ke}),s.a.createElement(B.a,{exact:!0,path:"/geo-objects/points",component:Ce}),s.a.createElement(P.a,{to:"/geo-objects"}))}}]),t}(s.a.Component),Te=Object(c.b)(null,function(e){return{dispatch:e}})(Object(ae.a)(De)),Me=a(54),_e=a(27),Ie=a.n(_e),Ae=(a(180),a(316),16),ze=[40.37937457190185,49.848964512348175];window.navigator&&window.navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){ze=[e.coords.latitude,e.coords.longitude]});var Be,Pe=!1,Ge=[],Ve={zoomControl:!0,zoom:13,maxZoom:18,minZoom:2,doubleClickZoom:!0,scrollWheelZoom:!0,dragging:!0,editable:!0,animate:!0,legends:!0,infoControl:!0,easeLinearity:10,attributionControl:!0};ue.a.drawLocal={draw:Object(m.a)({},ue.a.drawLocal.draw,{toolbar:Object(m.a)({},ue.a.drawLocal.draw.toolbar,{actions:!1,finish:!1,undo:!1,buttons:!1})}),edit:Object(m.a)({},ue.a.drawLocal.edit,{toolbar:Object(m.a)({},ue.a.drawLocal.edit.toolbar,{actions:Object(m.a)({},ue.a.drawLocal.edit.toolbar.actions,{save:{title:L.get("Save"),text:L.get("Save")},cancel:{title:L.get("Cancel"),text:L.get("Cancel")},clearAll:{title:L.get("ClearAll"),text:L.get("ClearAll")}}),buttons:{edit:L.get("EditLayers"),editDisabled:!1,remove:L.get("DeleteLayers"),removeDisabled:!1}}),handlers:{edit:{tooltip:!1},remove:{tooltip:!1}}})};var He=W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3});function Ue(e){for(var t in e)console.log(e[t])}function Re(e,t){return t.find(function(t){return t===e})}var Ye={overlay:{background:"rgba(0, 0, 0, 0.44)"},modal:{background:"rgba(0, 0, 0, 0)",boxShadow:"0 1px 7px rgba(0, 0, 0, 0.2)",borderRadius:"4px",padding:"0px",width:"100%",maxWidth:"400px"}},Fe={0:"#ff8585",1:"#55e642",2:"#ffe215"},We=function(e){function t(e){var a;Object(k.a)(this,t),Pe=!1,a=Object(M.a)(this,Object(_.a)(t).call(this,e));var n=Ie()(),s=Ie()(n).add(-1,"days"),o=s.format("YYYY-MM-DD"),i=n.format("YYYY-MM-DD"),c=s.format("HH:mm");return a.state={isLoading:!0,mLoading:!1,type:"objects",active_modal_id:!1,modals:[],objects:[],groups:[],types:[],icons:[],showIcons:!1,selectedIcon:!1,object:!1,watchList:[],map:{center:ze,zoom:Ae,layers:[]},dateFrom:o,dateTo:i,timeFrom:c},a.showModal=a.showModal.bind(Object(R.a)(Object(R.a)(a))),a.hideModal=a.hideModal.bind(Object(R.a)(Object(R.a)(a))),a.onSubmit=a.onSubmit.bind(Object(R.a)(Object(R.a)(a))),a.handleClickDelete=a.handleClickDelete.bind(Object(R.a)(Object(R.a)(a))),a.handleClickEdit=a.handleClickEdit.bind(Object(R.a)(Object(R.a)(a))),a.handleClickToggleWatchList=a.handleClickToggleWatchList.bind(Object(R.a)(Object(R.a)(a))),a.createMarker=a.createMarker.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"toggleSidebar",value:function(){this.props.dispatch({type:"TOGGLE_SIDEBAR"}),setTimeout(function(){Pe.invalidateSize()},200)}},{key:"changeType",value:function(e){this.state.type!==e&&this.setState({type:e})}},{key:"loadObjects",value:function(){var e=this;return D.get("objects.list",{limit:0},function(t){"success"===t.status&&e.setState({objects:t.data})})}},{key:"loadTypes",value:function(){var e=this;return D.get("data.objecttypes",{},function(t){"success"===t.status&&e.setState({types:t.data})})}},{key:"loadGroups",value:function(){var e=this;return D.get("groups.list",{},function(t){"success"===t.status&&e.setState({groups:t.data})})}},{key:"loadIcons",value:function(){var e=this;return D.get("data.icons",{limit:0},function(t){"success"===t.status&&e.setState({icons:t.data})})}},{key:"getObject",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,e.next=3,D.get("objects.info",{id:t},function(e){"success"===e.status&&a.setState({object:e.data})});case 3:return e.abrupt("return",a.state.object);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getItem",value:function(e){var t=this.state.objects.filter(function(t){if(t.id===e)return t});return t.length?t[0]:[]}},{key:"handleClickToggleWatchList",value:function(e){var t=this,a=this.state.watchList;Re(e,a)?a=this.state.watchList.filter(function(t){if(t&&t!==e)return t}):a.push(e),this.setState(Object(m.a)({},this.state,{watchList:a})),setTimeout(function(){t.removeLayers(),t.fitLayers(),t.fitBounds()},0)}},{key:"handleClickEdit",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showModal("edit"),this.setState({mLoading:!0,object:{title:"",type:{type:0}}}),e.next=4,this.getObject(t);case 4:(a=e.sent)&&this.setState({mLoading:!1,selectedIcon:!!a.icon&&a.icon,object:a,id:t});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleClickAdd",value:function(){this.showModal("add")}},{key:"handleClickDelete",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W()({title:L.get("DeleteAlertTitle"),text:L.get("DeleteAlertDescription"),type:"error",buttonsStyling:!1,showCancelButton:!0,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-secondary",confirmButtonText:L.get("YesDeleteIt"),cancelButtonText:L.get("Cancel")});case 2:(a=e.sent)&&a.value&&((n=this).setState({isLoading:!0,objects:[]}),D.get("objects.delete",{id:t},function(e){"success"===e.status?(n.setState({isLoading:!1}),He({type:"success",title:e.description}),n.loadObjects(),n.removeLayers(),n.fitLayers(),n.fitBounds()):(n.setState({isLoading:!1}),He({type:"error",title:e.description}))}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(e){Ue([this.state,this.refs]);var t=this,a=t.refs;if("add"===e)var n={title:a.title.value,type:a.type.value,imei:a.imei.value,phone:a.phone.value,group_id:a.group_id.value,icon:t.state.selectedIcon?t.state.selectedIcon:""};else n={id:t.state.id,title:a.title.value,phone:a.phone.value,type:a.type.value,icon:t.state.selectedIcon?t.state.selectedIcon:""};t.setState({isLoading:!0}),D.get({add:"objects.add",edit:"objects.edit"}[e],n,function(e){t.setState({isLoading:!1}),"success"===e.status?(He({type:"success",title:e.description}),setTimeout(function(){t.loadObjects(),t.hideModals(),t.removeLayers(),t.fitLayers(),t.fitBounds()},0)):He({type:"error",title:e.description})})}},{key:"showModal",value:function(e){var t=this.state.modals;t.push(e),this.setState(Object(m.a)({},this.state,{modals:t})),Ue(["showModal",e])}},{key:"hideModal",value:function(e){var t=this.state.modals;Re(e,t)&&(t=t.filter(function(t){if(t&&t!==e)return t}),this.setState(Object(m.a)({},this.state,{modals:t})))}},{key:"hideModals",value:function(){this.setState({modals:[]})}},{key:"selectIcon",value:function(e){var t=this;t.setState({selectedIcon:e}),setTimeout(function(){t.hideModal("icons")})}},{key:"initMap",value:function(){Pe||(Pe=ue.a.map("map",Ve).setView(this.state.map.center,this.state.map.zoom),ue.a.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(Pe),Be=new ue.a.LayerGroup,Pe.addLayer(Be))}},{key:"createMarker",value:function(e,t){var a=this,n=this;if(t.icon)var s={icon:ue.a.icon({iconUrl:"http://api.utigps.com/assets/svg/".concat(t.icon,".svg"),iconSize:[38,50],iconAnchor:[16,50],popupAnchor:[4,-25]})};else s={icon:ue.a.icon({iconUrl:"/assets/images/arrow.svg",iconSize:[24,24],iconAnchor:[12,24],popupAnchor:[0,0]}),rotationAngle:t.angle};var o=ue.a.marker(e,s);o.bindPopup(function(a){return'<div class="rnd-modal">\n\t\t\t\t<div class="rnd-header">\n\t\t\t\t\t<div class="rnd-title">'+t.title+'</div>\n\t\t\t\t\t<span class="custom-popup-close rnd-close">\n\t\t\t\t\t\t<i class="feather feather-x fs-24"></i>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="rnd-wrapper">\n\t\t\t\t\t<div class="rnd-content">\n\t\t\t\t\t\t<div class="rnd-body">\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<i class="feather feather-info"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("Status")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data d-flex align-items-center">\n\t\t\t\t\t\t\t\t\t\t<span>'+t.status.title+'</span>\n\t\t\t\t\t\t\t\t\t\t<span style="line-height:1;height:auto;padding:0;margin-left:5px;" class="icon-status">\n\t\t\t\t\t\t\t\t\t\t\t<span style="background:'+Fe[t.status.value]+'"></span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<i class="feather feather-calendar"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("LastMessage")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data">'+t.lastdate+'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<i class="feather feather-map-pin"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("Coordinates")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data">'+e.join(", ")+'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 1024 1024"><path d="M704 64l-320 320h-192l-192 256c0 0 203.416-56.652 322.066-30.084l-322.066 414.084 421.902-328.144c58.838 134.654-37.902 328.144-37.902 328.144l256-192v-192l320-320 64-320-320 64z"></path></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("Speed")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data">'+t.speed+"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>"},{className:"custom-leaflet-popup",closeButton:!1,maxWidth:400,minWidth:300});o.bindTooltip(t.title,{noHide:!0,className:"custom-tooltip",offset:[0,0]}),Be.addLayer(o).addTo(Pe),o.on("popupopen",function(e){n.setState({active_modal_id:t.id}),he()(".custom-popup-close").click(function(){o.closePopup(),a.setState({active_modal_id:!1})})}),this.state.active_modal_id===t.id&&o.openPopup()}},{key:"removeLayers",value:function(){Be.clearLayers()}},{key:"fitBounds",value:function(){Ge.length&&Pe.fitBounds(Ge)}},{key:"fitLayers",value:function(){var e=this,t=this.state,a=t.objects,n=t.watchList;Ge=[],a.map(function(t,a){if(Re(t.id,n)){var s=[t.coords.lat,t.coords.lon];e.createMarker(s,t),Ge.push(s)}})}},{key:"reload",value:function(){this.loadObjects(),this.removeLayers(),this.fitLayers()}},{key:"componentDidMount",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t=this;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),Pe||(Pe=new ue.a.Map("map",Ve).setView(ze,Ae),ue.a.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(Pe)),Be||(Be=new ue.a.LayerGroup,Pe.addLayer(Be)),e.next=5,this.loadObjects();case 5:return e.next=7,this.loadGroups();case 7:return e.next=9,this.loadTypes();case 9:return e.next=11,this.loadIcons();case 11:this.state.objects&&this.state.groups&&this.state.types&&this.state.icons&&this.setState({isLoading:!1}),this.interval||(this.timeout=setTimeout(function(){t.removeLayers(),t.fitLayers(),t.fitBounds()})),this.interval=setInterval(Object(j.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadObjects();case 2:t.removeLayers(),t.fitLayers(),t.fitBounds();case 5:case"end":return e.stop()}},e,this)})),15e3),he()(window).on("resize",function(){setTimeout(function(){Pe.invalidateSize()},200)}),Pe.on("click",function(){t.setState({active_modal_id:!1})});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearInterval(this.interval),Pe&&(Pe.invalidateSize(),Pe.off(),Pe.remove()),document.getElementById("map").innerHTML=""}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,n=(t.type,t.objects),o=t.watchList;t.modals;return s.a.createElement("div",{className:U()("app-container",{"show-sidebar":this.props.showSidebar})},s.a.createElement(oe,{title:L.get("Objects"),controller:"objects"}),s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"sidebar-wrapper"},s.a.createElement("div",{className:"sidebar-header"},s.a.createElement("ul",{className:"tabs justified flex-nowrap"},s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/groups",className:"link col",onClick:function(){return e.changeType("groups")}},s.a.createElement("i",{className:"icon feather feather-list"}),s.a.createElement("span",{className:"text"},L.get("Groups")))),s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/objects",className:"link col",onClick:function(){return e.changeType("objects")}},s.a.createElement("i",{className:"icon feather feather-wifi"}),s.a.createElement("span",{className:"text"},L.get("Objects"))),s.a.createElement("span",{className:"link col-auto py-0",onClick:function(){return e.handleClickAdd()}},s.a.createElement("i",{className:"feather feather-plus fs-20"}))))),s.a.createElement("div",{className:"sidebar-body"},a?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})):s.a.createElement("div",{className:"list visible CbSvVN"},!!n.length&&n.map(function(t,a){return s.a.createElement("div",{key:a,className:"item"},s.a.createElement("label",{className:"ui-checkbox blue col label watch text align-items-center text-truncate cursor-pointer"},s.a.createElement("input",{type:"checkbox",onChange:function(){return e.handleClickToggleWatchList(t.id)},checked:!!Re(t.id,o)}),s.a.createElement("span",{className:"label-text"},!!t.icon&&s.a.createElement("img",{className:"type-icon",src:"http://api.utigps.com/assets/svg/".concat(t.icon,".svg"),alt:""}),t.title)),s.a.createElement("span",{className:"col-auto"},s.a.createElement("span",{className:"icon-status",title:t.status.title},s.a.createElement("span",{style:{background:Fe[t.status.value]}}))),s.a.createElement("span",{className:"col-auto d-flex align-items-center"},s.a.createElement(re.Dropdown,{style:{right:"5px"},menuStyle:{minWidth:"150px"},placement:"bottomRight",renderTitle:function(){return s.a.createElement("span",{className:"button cursor-pointer"},s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"},s.a.createElement("circle",{cx:"12",cy:"12",r:"1"}),s.a.createElement("circle",{cx:"12",cy:"5",r:"1"}),s.a.createElement("circle",{cx:"12",cy:"19",r:"1"})))}},s.a.createElement(re.Dropdown.Item,{componentClass:Y.a,to:"/tracks/".concat(t.id,"?dateFrom=").concat(e.state.dateFrom,"&dateTo=").concat(e.state.dateTo,"&time=").concat(e.state.timeFrom)},s.a.createElement("i",{className:"feather feather-navigation mr-2"}),L.get("TrackForDay")),s.a.createElement(re.Dropdown.Item,{componentClass:Y.a,to:"/tracks/".concat(t.id)},s.a.createElement("i",{className:"feather feather-navigation mr-2"}),L.get("BuildTrack")),s.a.createElement(re.Dropdown.Item,{onSelect:function(){return e.handleClickEdit(t.id)}},s.a.createElement("i",{className:"feather feather-edit-2 mr-2"}),L.get("Edit")),s.a.createElement(re.Dropdown.Item,{onSelect:function(){return e.handleClickDelete(t.id)}},s.a.createElement("i",{className:"feather feather-trash mr-2"}),L.get("Delete")))))})))),s.a.createElement("span",{className:"btn-toggler",onClick:function(){return e.toggleSidebar()}},s.a.createElement("i",{className:"feather feather-chevrons-".concat(this.props.showSidebar?"left":"right")}))),s.a.createElement("div",{className:"main"},!!a&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"calc(100vh - 60px)",zIndex:999}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{className:"map-wrapper"},s.a.createElement("div",{id:"map"}))),s.a.createElement(Me.a,{open:!!Re("add",this.state.modals),onClose:function(){return e.hideModal("add")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:Ye},!!this.state.mLoading&&s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("AddObject")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("add")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},!!this.state.types.length&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("ObjectType"),":"),s.a.createElement("select",{ref:"type",className:"form-control custom-select"},s.a.createElement("option",{value:""},"--"),this.state.types.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),!!this.state.groups.length&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("SelectGroup"),":"),s.a.createElement("select",{ref:"group_id",className:"form-control custom-select"},s.a.createElement("option",{value:""},"--"),this.state.groups.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Title"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"title"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Imei"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"imei"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Phone"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"phone"})),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("span",{className:"cursor-pointer d-inline-block",onClick:function(){return e.showModal("icons")}},this.state.selectedIcon?s.a.createElement("img",{className:"align-top",width:"32",src:"http://api.utigps.com/assets/svg/".concat(this.state.selectedIcon,".svg"),alt:"Icon"}):s.a.createElement("img",{className:"align-top",width:"24",src:"/assets/images/marker.svg",alt:"Icon"})))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:function(){return e.onSubmit("add")}},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal("add")}},L.get("Cancel")))),s.a.createElement(Me.a,{open:!!Re("edit",this.state.modals),onClose:function(){return e.hideModal("edit")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:Ye},!this.state.object||this.state.mLoading?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk NYcv1i"})):s.a.createElement("div",null,s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("EditObject")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("edit")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},!!this.state.types.length&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("ObjectType"),":"),s.a.createElement("select",{ref:"type",className:"form-control custom-select",value:this.state.object.type.type,onChange:function(t){return e.setState(Object(m.a)({},e.state,{object:Object(m.a)({},e.state.object,{type:t.target.value})}))}},s.a.createElement("option",{value:""},"--"),this.state.types.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Title"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"title",value:this.state.object.title,onChange:function(t){return e.setState(Object(m.a)({},e.state,{object:Object(m.a)({},e.state.object,{title:t.target.value})}))}})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Phone"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"phone",value:this.state.object.phone,onChange:function(t){return e.setState(Object(m.a)({},e.state,{object:Object(m.a)({},e.state.object,{phone:t.target.value})}))}})),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("span",{className:"cursor-pointer d-inline-block",onClick:function(){return e.showModal("icons")}},this.state.selectedIcon?s.a.createElement("img",{className:"align-top",width:"32",src:"http://api.utigps.com/assets/svg/".concat(this.state.selectedIcon,".svg"),alt:"Icon"}):s.a.createElement("img",{className:"align-top",width:"24",src:"/assets/images/marker.svg",alt:"Icon"})))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:function(){return e.onSubmit("edit")}},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal("edit")}},L.get("Cancel"))))),s.a.createElement(Me.a,{open:!!Re("icons",this.state.modals),onClose:function(){return e.hideModal("icons")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:Ye},s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("SelectIcon")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("icons")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},s.a.createElement("div",{className:"icon-list"},this.state.icons&&this.state.icons.map(function(t,a){return s.a.createElement("span",{key:a,className:U()("icon",{active:e.state.selectedIcon===t.id}),onClick:function(){return e.selectIcon(t.id)}},s.a.createElement("img",{src:t.url,alt:""}))})))))))}}]),t}(s.a.Component),Ze=Object(c.b)(function(e){return{sidebarLoader:e.globals.sidebarLoader,showSidebar:e.globals.showSidebar,mainLoader:e.globals.mainLoader}},function(e){return{dispatch:e}})(We),Xe=function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){"POP"===this.props.history.action&&this.props.dispatch({type:"SET_HEADER_ACTIVE_LINK_ID",value:"objects"})}},{key:"render",value:function(){return s.a.createElement(z.a,null,s.a.createElement(B.a,{exact:!0,path:"/objects",component:Ze}),s.a.createElement(P.a,{to:"/objects"}))}}]),t}(s.a.Component),Je=Object(c.b)(null,function(e){return{dispatch:e}})(Object(ae.a)(Xe)),qe=a(187),Qe=(a(717),16),Ke=[40.37937457190185,49.848964512348175];window.navigator&&window.navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){Ke=[e.coords.latitude,e.coords.longitude]});var $e,et=!1,tt=[],at={zoomControl:!0,zoom:13,maxZoom:18,minZoom:2,doubleClickZoom:!0,scrollWheelZoom:!0,dragging:!0,editable:!0,animate:!0,legends:!0,infoControl:!0,easeLinearity:10,attributionControl:!0};ue.a.drawLocal={draw:Object(m.a)({},ue.a.drawLocal.draw,{toolbar:Object(m.a)({},ue.a.drawLocal.draw.toolbar,{actions:!1,finish:!1,undo:!1,buttons:!1})}),edit:Object(m.a)({},ue.a.drawLocal.edit,{toolbar:Object(m.a)({},ue.a.drawLocal.edit.toolbar,{actions:Object(m.a)({},ue.a.drawLocal.edit.toolbar.actions,{save:{title:L.get("Save"),text:L.get("Save")},cancel:{title:L.get("Cancel"),text:L.get("Cancel")},clearAll:{title:L.get("ClearAll"),text:L.get("ClearAll")}}),buttons:{edit:L.get("EditLayers"),editDisabled:!1,remove:L.get("DeleteLayers"),removeDisabled:!1}}),handlers:{edit:{tooltip:!1},remove:{tooltip:!1}}})};var nt=W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3});function st(e,t){return t.find(function(t){return t===e})}var ot,it={overlay:{background:"rgba(0, 0, 0, 0.44)"},modal:{background:"rgba(0, 0, 0, 0)",boxShadow:"0 1px 7px rgba(0, 0, 0, 0.2)",borderRadius:"4px",padding:"0px",width:"100%",maxWidth:"400px"}},ct={0:"#ff8585",1:"#55e642",2:"#ffe215"},rt=function(e){function t(e){var a;Object(k.a)(this,t),et=!1,(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).handleChangeObject=function(e){var t=e.map(function(e){return e.value});a.setState({selected_object_ids:e,object_ids:t})};var n=Ie()(),s=Ie()(n).add(-1,"days"),o=s.format("YYYY-MM-DD"),i=n.format("YYYY-MM-DD"),c=s.format("HH:mm");return a.state={isLoading:!0,mLoading:!1,latitude:"",longitude:"",type:"groups",active_modal_id:!1,modals:[],objectLabels:[],selected_object_ids:[],object_ids:[],objects:[],groups:[],types:[],icons:[],showIcons:!1,selectedIcon:!1,object:!1,group:!1,watchList:{},activeItems:[],map:{center:Ke,zoom:Qe,layers:[]},dateFrom:o,dateTo:i,timeFrom:c,isMounted:!1},a.getMyLocation=a.getMyLocation.bind(Object(R.a)(Object(R.a)(a))),a.showModal=a.showModal.bind(Object(R.a)(Object(R.a)(a))),a.hideModal=a.hideModal.bind(Object(R.a)(Object(R.a)(a))),a.onSubmit=a.onSubmit.bind(Object(R.a)(Object(R.a)(a))),a.deleteObject=a.deleteObject.bind(Object(R.a)(Object(R.a)(a))),a.deleteGroup=a.deleteGroup.bind(Object(R.a)(Object(R.a)(a))),a.editObject=a.editObject.bind(Object(R.a)(Object(R.a)(a))),a.editGroup=a.editGroup.bind(Object(R.a)(Object(R.a)(a))),a.toggleWatchList=a.toggleWatchList.bind(Object(R.a)(Object(R.a)(a))),a.createMarker=a.createMarker.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"toggleAccordion",value:function(e){var t=this.state.activeItems;st(e,t)?t=this.state.activeItems.filter(function(t){if(t&&t!==e)return t}):t.push(e),this.setState({activeItems:t})}},{key:"toggleSidebar",value:function(){this.props.dispatch({type:"TOGGLE_SIDEBAR"}),setTimeout(function(){et.invalidateSize()},200)}},{key:"changeType",value:function(e){this.state.type!==e&&this.setState({type:e})}},{key:"loadObjects",value:function(){var e=this;return D.get("objects.listbygroup",{limit:0},function(t){if("success"===t.status){var a=[];t.data.map(function(e){e.objects&&"none"===e.id&&e.objects.map(function(e){a.push({label:e.title,value:e.id})})}),e.state.isMounted&&e.setState({objects:t.data,objectLabels:a})}})}},{key:"loadTypes",value:function(){var e=this;return D.get("data.objecttypes",{},function(t){"success"===t.status&&e.state.isMounted&&e.setState({types:t.data})})}},{key:"loadGroups",value:function(){var e=this;return D.get("groups.list",{},function(t){"success"===t.status&&e.state.isMounted&&e.setState({groups:t.data})})}},{key:"loadIcons",value:function(){var e=this;return D.get("data.icons",{limit:0},function(t){"success"===t.status&&e.state.isMounted&&e.setState({icons:t.data})})}},{key:"getObject",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,e.next=3,D.get("objects.info",{id:t},function(e){"success"===e.status&&a.state.isMounted&&a.setState({object:e.data})});case 3:return e.abrupt("return",a.state.object);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGroup",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,e.next=3,D.get("groups.info",{id:t},function(e){"success"===e.status&&a.state.isMounted&&a.setState({group:e.data})});case 3:return e.abrupt("return",a.state.group);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getItem",value:function(e){var t=this.state.objects.filter(function(t){if(t.id===e)return t});return t.length?t[0]:[]}},{key:"toggleWatchList",value:function(e,t){var a=this,n=this.state,s=n.watchList,o=n.objects;if("all"===t)if(s[e])delete s[e];else{var i=[];o.map(function(t,a){t.id===e&&t.objects.map(function(e){i.push(e.id)})}),s[e]=i}else if(s[e]&&st(t,s[e]))s[e]=this.state.watchList[e].filter(function(e){if(e&&e!==t)return e}),s[e].length||delete s[e];else{if(s[e])i=s[e];else i=[];i.push(t),s[e]=i}this.setState({watchList:s}),setTimeout(function(){a.removeLayers(),a.fitLayers(),a.fitBounds()},0)}},{key:"editObject",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showModal("object-edit"),this.setState({mLoading:!0,object:{title:"",type:{type:0}}}),e.next=4,this.getObject(t);case 4:(a=e.sent)&&this.setState({mLoading:!1,selectedIcon:!!a.icon&&a.icon,object:a,id:t});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editGroup",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showModal("group-edit"),this.setState({mLoading:!0,group:{title:""}}),e.next=4,this.getGroup(t);case 4:(a=e.sent)&&(n=a.objects.map(function(e){return{label:e.title,value:e.id}}),this.setState({mLoading:!1,selected_object_ids:n,group:a,id:t}));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addGroup",value:function(){var e=Object(j.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.showModal("group-add");case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteObject",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W()({title:L.get("DeleteAlertTitle"),text:L.get("DeleteAlertDescription"),type:"error",buttonsStyling:!1,showCancelButton:!0,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-secondary",confirmButtonText:L.get("YesDeleteIt"),cancelButtonText:L.get("Cancel")});case 2:(a=e.sent)&&a.value&&((n=this).setState({isLoading:!0,objects:[]}),D.get("objects.delete",{id:t},function(e){"success"===e.status?(n.setState({isLoading:!1}),nt({type:"success",title:e.description}),n.loadObjects(),n.hideModals(),n.removeLayers(),n.fitLayers(),n.fitBounds()):(n.setState({isLoading:!1}),nt({type:"error",title:e.description}))}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteGroup",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W()({title:L.get("DeleteAlertTitle"),text:L.get("DeleteAlertDescription"),type:"error",buttonsStyling:!1,showCancelButton:!0,confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-secondary",confirmButtonText:L.get("YesDeleteIt"),cancelButtonText:L.get("Cancel")});case 2:(a=e.sent)&&a.value&&((n=this).setState({isLoading:!0,items:[]}),D.get("groups.delete",{id:t},function(e){"success"===e.status?(n.setState({isLoading:!1}),nt({type:"success",title:e.description}),n.loadObjects(),n.removeLayers(),n.fitLayers(),n.fitBounds()):(n.setState({isLoading:!1}),nt({type:"error",title:e.description}))}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(e){!function(e){for(var t in e)console.log(e[t])}([this.state,this.refs]);var t=this,a=t.refs;if("object-add"===e)var n={title:a.title.value,type:a.type.value,phone:a.phone.value,imei:a.imei.value,group_id:a.group_id.value};else if("object-edit"===e)n={id:t.state.id,title:a.title.value,phone:a.phone.value,type:a.type.value,icon:t.state.selectedIcon?t.state.selectedIcon:""};else if("group-add"===e)n={title:a.title.value,object_ids:t.state.object_ids};else if("group-edit"===e)n={id:t.state.id,title:a.title.value,object_ids:t.state.object_ids};t.setState({isLoading:!0}),D.get({"object-add":"objects.add","object-edit":"objects.edit","group-add":"groups.add","group-edit":"groups.edit"}[e],n,function(e){t.setState({isLoading:!1}),"success"===e.status?(nt({type:"success",title:e.description}),setTimeout(function(){t.loadObjects(),t.hideModals(),t.removeLayers(),t.fitLayers(),t.fitBounds()},0)):nt({type:"error",title:e.description})})}},{key:"showModal",value:function(e){var t=this.state.modals;t.push(e),this.setState(Object(m.a)({},this.state,{modals:t}))}},{key:"hideModal",value:function(e){var t=this.state.modals;st(e,t)&&(t=t.filter(function(t){if(t&&t!==e)return t}),this.setState(Object(m.a)({},this.state,{modals:t})))}},{key:"hideModals",value:function(){this.setState({modals:[]})}},{key:"selectIcon",value:function(e){var t=this;t.setState({selectedIcon:e}),setTimeout(function(){t.hideModal("icons")})}},{key:"createMarker",value:function(e,t){var a=this,n=this;if(t.icon)var s={icon:ue.a.icon({iconUrl:"http://api.utigps.com/assets/svg/".concat(t.icon,".svg"),iconSize:[38,50],iconAnchor:[16,50],popupAnchor:[4,-25]})};else s={icon:ue.a.icon({iconUrl:"/assets/images/arrow.svg",iconSize:[24,24],iconAnchor:[12,24],popupAnchor:[0,0]}),rotationAngle:t.angle};var o=ue.a.marker(e,s);o.bindPopup(function(a){return'<div class="rnd-modal">\n\t\t\t\t<div class="rnd-header">\n\t\t\t\t\t<div class="rnd-title">'+t.title+'</div>\n\t\t\t\t\t<span class="custom-popup-close rnd-close">\n\t\t\t\t\t\t<i class="feather feather-x fs-24"></i>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="rnd-wrapper">\n\t\t\t\t\t<div class="rnd-content">\n\t\t\t\t\t\t<div class="rnd-body">\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<i class="feather feather-info"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("Status")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data d-flex align-items-center">\n\t\t\t\t\t\t\t\t\t\t<span>'+t.status.title+'</span>\n\t\t\t\t\t\t\t\t\t\t<span style="line-height:1;height:auto;padding:0;margin-left:5px;" class="icon-status">\n\t\t\t\t\t\t\t\t\t\t\t<span style="background:'+ct[t.status.value]+'"></span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<i class="feather feather-calendar"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("LastMessage")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data">'+t.lastdate+'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<i class="feather feather-map-pin"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("Coordinates")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data">'+e.join(", ")+'</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="window-box">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 1024 1024"><path d="M704 64l-320 320h-192l-192 256c0 0 203.416-56.652 322.066-30.084l-322.066 414.084 421.902-328.144c58.838 134.654-37.902 328.144-37.902 328.144l256-192v-192l320-320 64-320-320 64z"></path></svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="details">\n\t\t\t\t\t\t\t\t\t<div class="title">'+L.get("Speed")+'</div>\n\t\t\t\t\t\t\t\t\t<div class="data">'+t.speed+"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>"},{className:"custom-leaflet-popup",closeButton:!1,maxWidth:400,minWidth:300}),o.bindTooltip(t.title,{noHide:!0,className:"custom-tooltip",offset:[0,0]}),$e.addLayer(o).addTo(et),o.on("popupopen",function(e){n.setState({active_modal_id:t.id}),he()(".custom-popup-close").click(function(){et.closePopup(),a.setState({active_modal_id:!1})})}),this.state.active_modal_id===t.id&&o.openPopup()}},{key:"removeLayers",value:function(){$e.clearLayers()}},{key:"fitBounds",value:function(){tt.length&&et.fitBounds(tt)}},{key:"fitLayers",value:function(){var e=this,t=this.state,a=t.objects,n=t.watchList,s=[];tt=[],a.map(function(t){n[t.id]&&n[t.id].length&&t.objects.map(function(a){if(st(a.id,n[t.id])&&!st(a.id,s)){s.push(a.id);var o=[a.coords.lat,a.coords.lon];e.createMarker(o,a),tt.push(o)}})})}},{key:"reload",value:function(){var e=Object(j.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadObjects();case 2:this.removeLayers(),this.fitLayers();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t=this;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0,isMounted:!0}),et||(et=new ue.a.Map("map",at).setView(Ke,Qe),ue.a.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(et)),$e||($e=new ue.a.LayerGroup,et.addLayer($e)),e.next=5,this.loadObjects();case 5:return e.next=7,this.loadGroups();case 7:return e.next=9,this.loadTypes();case 9:return e.next=11,this.loadIcons();case 11:this.state.objects&&this.state.groups&&this.state.types&&this.state.icons&&(this.setState({isLoading:!1}),console.log(this.objects),this.interval||(this.timeout=setTimeout(function(){t.removeLayers(),t.fitLayers(),t.fitBounds()})),this.interval=setInterval(Object(j.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadObjects();case 2:t.removeLayers(),t.fitLayers(),t.fitBounds();case 5:case"end":return e.stop()}},e,this)})),15e3)),he()(window).on("resize",function(){setTimeout(function(){et.invalidateSize()},100)}),et.on("click",function(){t.setState({active_modal_id:!1})}),console.log("componentDidMount");case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){console.log("componentDidUpdate")}},{key:"componentWillUnmount",value:function(){this.setState({isMounted:!1}),clearInterval(this.interval),et&&(et.invalidateSize(),et.off(),et.remove()),document.getElementById("map").innerHTML=""}},{key:"getMyLocation",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,n=(t.type,t.objects),o=t.watchList,i=t.activeItems;return s.a.createElement("div",{className:U()("app-container",{"show-sidebar":this.props.showSidebar})},s.a.createElement(oe,{title:L.get("Objects"),controller:"objects"}),s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"sidebar-wrapper"},s.a.createElement("div",{className:"sidebar-header"},s.a.createElement("ul",{className:"tabs justified flex-nowrap"},s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/groups",className:"link col",onClick:function(){return e.changeType("groups")}},s.a.createElement("i",{className:"icon feather feather-list"}),s.a.createElement("span",{className:"text"},L.get("Groups"))),s.a.createElement("span",{className:"link col-auto py-0",onClick:function(){return e.addGroup()}},s.a.createElement("i",{className:"feather feather-plus fs-20"}))),s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/objects",className:"link col",onClick:function(){return e.changeType("objects")}},s.a.createElement("i",{className:"icon feather feather-wifi"}),s.a.createElement("span",{className:"text"},L.get("Objects")))))),s.a.createElement("div",{className:"sidebar-body"},a?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})):s.a.createElement("div",{className:"accordion wrWp11"},!!n.length&&n.map(function(t,a){return s.a.createElement("div",{key:a,className:U()("item",{active:st(t.id,i)})},s.a.createElement("div",{className:"item-header"},s.a.createElement("label",{className:"col-auto watch text d-flex ui-checkbox blue align-items-center cursor-pointer"},s.a.createElement("input",{type:"checkbox",onChange:function(){return e.toggleWatchList(t.id,"all")},checked:!!o[t.id]}),s.a.createElement("span",{className:"label-text"})),s.a.createElement("div",{className:"col label text cursor-pointer d-flex",onClick:function(){return e.toggleAccordion(t.id)}},s.a.createElement("span",{className:"text-truncate",style:{fontWeight:600}},t.title),s.a.createElement("span",{className:"ml-auto"},t.objects.length)),s.a.createElement("div",{className:"col-auto actions"},s.a.createElement("span",{className:"button cursor-pointer",onClick:function(){return e.toggleAccordion(t.id)}},s.a.createElement("svg",{className:"caret",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},(st(t.id,i),s.a.createElement("polyline",{points:"6 9 12 15 18 9"})))),t.id>0&&s.a.createElement(re.Dropdown,{style:{right:"5px"},menuStyle:{minWidth:"150px"},placement:"bottomRight",renderTitle:function(){return s.a.createElement("span",{className:"button cursor-pointer"},s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},s.a.createElement("circle",{cx:"12",cy:"12",r:"3"}),s.a.createElement("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})))}},s.a.createElement(re.Dropdown.Item,{onSelect:function(){return e.editGroup(t.id)}},s.a.createElement("i",{className:"feather feather-edit-2 mr-2"}),L.get("Edit")),s.a.createElement(re.Dropdown.Item,{onSelect:function(){return e.deleteGroup(t.id)}},s.a.createElement("i",{className:"feather feather-trash mr-2"}),L.get("Delete"))))),s.a.createElement("div",{className:"item-body"},s.a.createElement("div",{className:"list CbSvVN"},t.objects.map(function(a,n){return s.a.createElement("div",{key:n,className:"item"},s.a.createElement("label",{className:"pl-4 ui-checkbox blue col label watch text align-items-center text-truncate cursor-pointer"},s.a.createElement("input",{type:"checkbox",onChange:function(){return e.toggleWatchList(t.id,a.id)},checked:!(!o[t.id]||!st(a.id,o[t.id]))}),s.a.createElement("span",{className:"label-text",style:{color:"inherit"}},!!a.icon&&s.a.createElement("img",{className:"type-icon",src:"http://api.utigps.com/assets/svg/".concat(a.icon,".svg"),alt:""}),a.title)),s.a.createElement("span",{className:"col-auto"},s.a.createElement("span",{className:"icon-status",title:a.status.title},s.a.createElement("span",{style:{background:ct[a.status.value]}}))),s.a.createElement("span",{className:"col-auto d-flex align-items-center"},s.a.createElement(re.Dropdown,{style:{right:"5px"},menuStyle:{minWidth:"150px"},placement:"bottomRight",renderTitle:function(){return s.a.createElement("span",{className:"button cursor-pointer"},s.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"},s.a.createElement("circle",{cx:"12",cy:"12",r:"1"}),s.a.createElement("circle",{cx:"12",cy:"5",r:"1"}),s.a.createElement("circle",{cx:"12",cy:"19",r:"1"})))}},s.a.createElement(re.Dropdown.Item,{componentClass:Y.a,to:"/tracks/".concat(a.id,"?dateFrom=").concat(e.state.dateFrom,"&dateTo=").concat(e.state.dateTo,"&time=").concat(e.state.timeFrom)},s.a.createElement("i",{className:"feather feather-navigation mr-2"}),L.get("TrackForDay")),s.a.createElement(re.Dropdown.Item,{componentClass:Y.a,to:"/tracks/".concat(a.id)},s.a.createElement("i",{className:"feather feather-navigation mr-2"}),L.get("BuildTrack")),s.a.createElement(re.Dropdown.Item,{onSelect:function(){return e.editObject(a.id)}},s.a.createElement("i",{className:"feather feather-edit-2 mr-2"}),L.get("Edit")),s.a.createElement(re.Dropdown.Item,{onSelect:function(){return e.deleteObject(a.id)}},s.a.createElement("i",{className:"feather feather-trash mr-2"}),L.get("Delete")))))}))))})))),s.a.createElement("span",{className:"btn-toggler",onClick:function(){return e.toggleSidebar()}},s.a.createElement("i",{className:"feather feather-chevrons-".concat(this.props.showSidebar?"left":"right")}))),s.a.createElement("div",{className:"main"},!!a&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"calc(100vh - 60px)",zIndex:999}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{className:"map-wrapper"},s.a.createElement("div",{id:"map"}))),s.a.createElement(Me.a,{open:!!st("object-add",this.state.modals),onClose:function(){return e.hideModal("object-add")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:it},!!this.state.mLoading&&s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("AddObject")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("object-add")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},!!this.state.types.length&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("ObjectType"),":"),s.a.createElement("select",{ref:"type",className:"form-control custom-select"},s.a.createElement("option",{value:""},"--"),this.state.types.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),!!this.state.groups.length&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("SelectGroup"),":"),s.a.createElement("select",{ref:"group_id",className:"form-control custom-select"},s.a.createElement("option",{value:""},"--"),this.state.groups.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Title"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"title"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Phone"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"phone"})),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("label",null,L.get("Imei"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"imei"}))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:function(){return e.onSubmit("object-add")}},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal("object-add")}},L.get("Cancel")))),s.a.createElement(Me.a,{open:!!st("object-edit",this.state.modals),onClose:function(){return e.hideModal("object-edit")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:it},!this.state.object||this.state.mLoading?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk NYcv1i"})):s.a.createElement("div",null,s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("EditObject")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("object-edit")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},!!this.state.types.length&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("ObjectType"),":"),s.a.createElement("select",{ref:"type",className:"form-control custom-select",value:this.state.object.type.type,onChange:function(t){return e.setState(Object(m.a)({},e.state,{object:Object(m.a)({},e.state.object,{type:t.target.value})}))}},s.a.createElement("option",{value:""},"--"),this.state.types.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)}))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Title"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"title",value:this.state.object.title,onChange:function(t){return e.setState(Object(m.a)({},e.state,{object:Object(m.a)({},e.state.object,{title:t.target.value})}))}})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Phone"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"phone",value:this.state.object.phone,onChange:function(t){return e.setState(Object(m.a)({},e.state,{object:Object(m.a)({},e.state.object,{phone:t.target.value})}))}})),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("span",{className:"cursor-pointer d-inline-block",onClick:function(){return e.showModal("icons")}},this.state.selectedIcon?s.a.createElement("img",{className:"align-top",width:"32",src:"http://api.utigps.com/assets/svg/".concat(this.state.selectedIcon,".svg"),alt:"Icon"}):s.a.createElement("img",{className:"align-top",width:"24",src:"/assets/images/marker.svg",alt:"Icon"})))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:function(){return e.onSubmit("object-edit")}},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal("object-edit")}},L.get("Cancel"))))),s.a.createElement(Me.a,{open:!!st("group-add",this.state.modals),onClose:function(){return e.hideModal("group-add")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:it},!!this.state.mLoading&&s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk NYcv1i"})),s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("AddGroup")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("group-add")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Title"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"title"})),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("label",null,L.get("Objects"),":"),s.a.createElement(qe.a,{defaultValue:[],isMulti:!0,name:"object_ids",options:this.state.objectLabels,closeMenuOnSelect:!1,onChange:this.handleChangeObject.bind(this)}))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:function(){return e.onSubmit("group-add")}},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal("group-add")}},L.get("Cancel")))),s.a.createElement(Me.a,{open:!!st("group-edit",this.state.modals),onClose:function(){return e.hideModal("group-edit")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:it},!this.state.group||this.state.mLoading?s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk NYcv1i"})):s.a.createElement("div",null,s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("EditGroup")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("group-edit")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,L.get("Title"),":"),s.a.createElement("input",{type:"text",className:"form-control",ref:"title",value:this.state.group.title,onChange:function(t){return e.setState(Object(m.a)({},e.state,{group:Object(m.a)({},e.state.group,{title:t.target.value})}))}})),s.a.createElement("div",{className:"form-group mb-0"},s.a.createElement("label",null,L.get("Objects"),":"),s.a.createElement(qe.a,{defaultValue:[],isMulti:!0,name:"object_ids",value:this.state.selected_object_ids,options:this.state.objectLabels,closeMenuOnSelect:!1,onChange:this.handleChangeObject.bind(this)}))))),s.a.createElement("div",{className:"rnd-footer"},s.a.createElement("button",{type:"button",className:"btn btn-sm btn-success py-1 px-2 mr-2",onClick:function(){return e.onSubmit("group-edit")}},L.get("BtnSave")),s.a.createElement("button",{type:"button",className:"btn btn-sm btn-info py-1 px-2",onClick:function(){return e.hideModal("group-edit")}},L.get("Cancel"))))),s.a.createElement(Me.a,{open:!!st("icons",this.state.modals),onClose:function(){return e.hideModal("icons")},closeOnOverlayClick:!0,center:!0,showCloseIcon:!1,animationDuration:0,styles:it},s.a.createElement("div",{className:"rnd-header"},s.a.createElement("div",{className:"rnd-title"},L.get("SelectIcon")),s.a.createElement("span",{className:"rnd-close",onClick:function(){return e.hideModal("icons")}},s.a.createElement("i",{className:"feather feather-x fs-24"}))),s.a.createElement("div",{className:"rnd-wrapper"},s.a.createElement("div",{className:"rnd-content"},s.a.createElement("div",{className:"rnd-body"},s.a.createElement("div",{className:"icon-list"},this.state.icons&&this.state.icons.map(function(t,a){return s.a.createElement("span",{key:a,className:U()("icon",{active:e.state.selectedIcon===t.id}),onClick:function(){return e.selectIcon(t.id)}},s.a.createElement("img",{src:t.url,alt:""}))})))))))}}]),t}(s.a.Component),lt=Object(c.b)(function(e){return{showSidebar:e.globals.showSidebar}},function(e){return{dispatch:e}})(rt),mt=function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){"POP"===this.props.history.action&&this.props.dispatch({type:"SET_HEADER_ACTIVE_LINK_ID",value:"objects"})}},{key:"render",value:function(){return s.a.createElement(z.a,null,s.a.createElement(B.a,{exact:!0,path:"/groups",component:lt}),s.a.createElement(P.a,{to:"/groups"}))}}]),t}(s.a.Component),dt=Object(c.b)(null,function(e){return{dispatch:e}})(Object(ae.a)(mt)),ut=function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).logout=a.logout.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"logout",value:function(){this.props.dispatch({type:"INIT_APP"}),this.props.dispatch({type:"USER_LOGOUT"}),x.a.remove("_token",{path:"/"}),window.location="/"}},{key:"render",value:function(){var e=this,t=this.props.user;return s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"border-bottom p-3"},s.a.createElement("div",{className:"row flex-column align-items-center justify-content-center"},s.a.createElement("div",{className:"col-7 mb-3"},s.a.createElement("img",{src:"/assets/images/user-3.png",alt:"",className:"w-100"})),s.a.createElement("div",{className:"col-auto"},s.a.createElement("h6",null,t.data.fullname)))),s.a.createElement("div",{className:"sidebar-menu"},s.a.createElement("div",{className:"item"},s.a.createElement("div",{className:"link",onClick:function(){return e.logout()}},s.a.createElement("i",{className:"icon feather feather-log-out"}),s.a.createElement("span",{className:"text"},L.get("Logout"))))))}}]),t}(s.a.Component),pt=Object(c.b)(function(e){return{user:e.user}},function(e){return{dispatch:e}})(ut),ht=W.a.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:5e3}),ft=function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).submit=function(e){e.preventDefault();var t=Object(R.a)(Object(R.a)(a));t.setState({isLoading:!0}),D.get("account.update",{id:t.state.id,fullname:t.state.fullname,country:t.state.country},function(e){setTimeout(function(){t.setState({isLoading:!1}),"success"===e.status?(ht({type:"success",title:e.description}),t.props.dispatch({type:"SET_USER_DATA",value:e.data})):ht({type:"error",title:e.description})},500)},function(e){setTimeout(function(){t.setState({isLoading:!1}),ht({type:"error",title:e.description})},500)})},a.state={isLoading:!1,id:e.user.data.id,fullname:e.user.data.fullname,phone:e.user.data.phone,email:e.user.data.email,country:e.user.data.country.id,photo:e.user.data.photo,email_verified:e.user.data.email_verified,phone_verified:e.user.data.phone_verified,type:e.user.data.type,countryList:[]},a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"getUserInfo",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,D.get("account.info",{},function(e){"success"===e.status&&t.setState({id:e.data.id,fullname:e.data.fullname,phone:e.data.phone,email:e.data.email,country:e.data.country.id,photo:e.data.photo,email_verified:e.data.email_verified,phone_verified:e.data.phone_verified,type:e.data.type})});case 3:return e.abrupt("return",!1!==t.state.id);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getCountryList",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,D.get("data.countries",{},function(e){"success"===e.status&&t.setState({countryList:e.data})});case 3:return e.abrupt("return",t.state.countryList.length);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(j.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),e.next=3,this.getCountryList();case 3:e.sent&&this.setState({isLoading:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"app-container show-sidebar sidebar-sm"},s.a.createElement(oe,{title:L.get("PersonalInformation"),controller:"account"}),s.a.createElement(pt,null),s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"panel r-b r-t-r"},s.a.createElement("div",{className:"panel-wrapper"},s.a.createElement("div",{className:"panel-header"},s.a.createElement("ul",{className:"tabs"},s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/account",className:"link"},s.a.createElement("i",{className:"icon feather feather-info"}),s.a.createElement("span",{className:"text"},L.get("PersonalInformation")))),s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/account/changepassword",className:"link"},s.a.createElement("i",{className:"icon feather feather-lock"}),s.a.createElement("span",{className:"text"},L.get("ChangePassword")))),s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/account/verifyemail",className:"link"},s.a.createElement("i",{className:"icon feather feather-at-sign"}),s.a.createElement("span",{className:"text"},L.get("VerifyEmail")))))),s.a.createElement("div",{className:"panel-body"},!!this.state.isLoading&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"100%"}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("form",{action:"",onSubmit:this.submit.bind(this)},s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-md-2 text-md-right"},L.get("Fullname"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("input",{type:"text",className:"form-control",ref:"title",value:this.state.fullname,onChange:function(t){return e.setState({fullname:t.target.value})}}))),s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-md-2 text-md-right"},L.get("Country"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("select",{className:"form-control custom-select",ref:"country",value:this.state.country,onChange:function(t){return e.setState({country:t.target.value})}},s.a.createElement("option",{key:-1,value:""},"--"),this.state.countryList.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)})))),s.a.createElement("div",{className:"row"},s.a.createElement("label",{className:"col-md-2"}),s.a.createElement("div",{className:"col-md-auto"},s.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},s.a.createElement("i",{className:"feather feather-check mr-2 fs-18"}),L.get("BtnSave"))))))))))}}]),t}(s.a.Component),bt=Object(c.b)(function(e){return{user:e.user}},function(e){return{dispatch:e}})(ft),gt=W.a.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:5e3}),vt=function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).submit=function(e){e.preventDefault();var t=Object(R.a)(Object(R.a)(a));t.setState({isLoading:!0}),D.get("account.password",{id:t.state.id,oldpassword:t.refs.oldpassword.value,password:t.refs.password.value,repassword:t.refs.repassword.value},function(e){setTimeout(function(){t.setState({isLoading:!1}),"success"===e.status?gt({type:"success",title:e.description}):gt({type:"error",title:e.description})},500)},function(e){setTimeout(function(){t.setState({isLoading:!1}),gt({type:"error",title:e.description})},500)})},a.state={isLoading:!1},a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"app-container show-sidebar sidebar-sm"},s.a.createElement(oe,{title:L.get("ChangePassword"),controller:"account"}),s.a.createElement(pt,null),s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"panel r-b r-t-r"},s.a.createElement("div",{className:"panel-wrapper"},s.a.createElement("div",{className:"panel-header"},s.a.createElement("ul",{className:"tabs"},s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/account",className:"link"},s.a.createElement("i",{className:"icon feather feather-info"}),s.a.createElement("span",{className:"text"},L.get("PersonalInformation")))),s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/account/changepassword",className:"link"},s.a.createElement("i",{className:"icon feather feather-lock"}),s.a.createElement("span",{className:"text"},L.get("ChangePassword")))),s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/account/verifyemail",className:"link"},s.a.createElement("i",{className:"icon feather feather-at-sign"}),s.a.createElement("span",{className:"text"},L.get("VerifyEmail")))))),s.a.createElement("div",{className:"panel-body"},!!this.state.isLoading&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"100%"}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("form",{action:"",onSubmit:this.submit.bind(this)},s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-md-2 text-md-right"},L.get("OldPassword"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("input",{type:"password",className:"form-control",ref:"oldpassword"}))),s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-md-2 text-md-right"},L.get("NewPassword"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("input",{type:"password",className:"form-control",ref:"password"}))),s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-md-2 text-md-right"},L.get("RePassword"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("input",{type:"password",className:"form-control",ref:"repassword"}))),s.a.createElement("div",{className:"row"},s.a.createElement("label",{className:"col-md-2"}),s.a.createElement("div",{className:"col-md-auto"},s.a.createElement("button",{type:"submit",className:"btn btn-success btn-block"},s.a.createElement("i",{className:"feather feather-check mr-2 fs-18"}),L.get("BtnChangePassword"))))))))))}}]),t}(s.a.Component),Et=Object(c.b)(function(e){return{user:e.user}},function(e){return{dispatch:e}})(vt),yt=W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3}),wt=function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).submit=function(e){e.preventDefault();var t=a.props.user,n=Object(R.a)(Object(R.a)(a)),s=a.refs;switch(n.setState(Object(m.a)({},n.state,{isLoading:!0})),a.state.step){case 1:D.get("account.verifyemail.step1",{email:s.email.value},function(e){n.setState({isLoading:!1}),"success"===e.status?(n.setState(Object(m.a)({},n.state,{step:2})),yt({type:"success",title:e.description})):yt({type:"error",title:e.description})});break;case 2:D.get("account.verifyemail.step2",{email:n.state.email,code:s.code.value},function(e){n.setState({isLoading:!1}),"success"===e.status?(n.setState(Object(m.a)({},n.state,{step:1,status:!0,email:n.state.email})),t.data.email_verified=!0,t.data.email=n.state.email,yt({type:"success",title:e.description})):yt({type:"error",title:e.description})});break;default:return!1}},a.state={isLoading:!1,step:1,email:e.user.data.email,status:e.user.data.email_verified,code:""},a.submit=a.submit.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props.user)}},{key:"render",value:function(){var e=this,t=this.state,a=t.step,n=t.isLoading;return s.a.createElement("div",{className:"app-container show-sidebar sidebar-sm"},s.a.createElement(oe,{title:L.get("VerifyEmail"),controller:"account"}),s.a.createElement(pt,null),s.a.createElement("div",{className:"main"},s.a.createElement("div",{className:"panel r-b r-t-r"},s.a.createElement("div",{className:"panel-wrapper"},s.a.createElement("div",{className:"panel-header"},s.a.createElement("ul",{className:"tabs"},s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/account",className:"link"},s.a.createElement("i",{className:"icon feather feather-info"}),s.a.createElement("span",{className:"text"},L.get("PersonalInformation")))),s.a.createElement("li",{className:"item"},s.a.createElement(Y.a,{to:"/account/changepassword",className:"link"},s.a.createElement("i",{className:"icon feather feather-lock"}),s.a.createElement("span",{className:"text"},L.get("ChangePassword")))),s.a.createElement("li",{className:"item active"},s.a.createElement(Y.a,{to:"/account/verifyemail",className:"link"},s.a.createElement("i",{className:"icon feather feather-at-sign"}),s.a.createElement("span",{className:"text"},L.get("VerifyEmail")))))),s.a.createElement("div",{className:"panel-body"},!!n&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"100%"}},s.a.createElement("div",{className:"loader gVt9Xk"})),1===a?s.a.createElement("form",{onSubmit:this.submit},s.a.createElement("div",{className:"form-group row no-gutters"},s.a.createElement("label",{className:"col-md-2 col-form-label pt-0"},L.get("Email"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("input",{type:"text",ref:"email",name:"email",className:"form-control",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}}))),s.a.createElement("div",{className:"row no-gutters mt-2"},s.a.createElement("label",{className:"col-md-2 col-form-label pt-0"}),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("button",{className:"btn btn-success px-5",type:"submit"},L.get("Change"))))):2===a?s.a.createElement("form",{onSubmit:this.submit},s.a.createElement("div",{className:"form-group row no-gutters"},s.a.createElement("label",{className:"col-md-2 col-form-label pt-0"},L.get("ConfirmationCode"),":"),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("input",{type:"text",ref:"code",name:"code",className:"form-control",value:this.state.code,onChange:function(t){return e.setState({code:t.target.value})}}))),s.a.createElement("div",{className:"row no-gutters mt-2"},s.a.createElement("label",{className:"col-md-2 col-form-label pt-0"}),s.a.createElement("div",{className:"col-md-10"},s.a.createElement("button",{className:"btn btn-success px-5",type:"submit"},L.get("Confirm"))))):L.get("YourEmailHasBeenConfirmed"))))))}}]),t}(s.a.Component),Nt=Object(c.b)(function(e){return{user:e.user}},function(e){return{dispatch:e}})(wt),jt=function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){"POP"===this.props.history.action&&this.props.dispatch({type:"SET_HEADER_ACTIVE_LINK_ID",value:"account"})}},{key:"render",value:function(){return s.a.createElement(z.a,null,s.a.createElement(B.a,{exact:!0,path:"/account",component:bt}),s.a.createElement(B.a,{exact:!0,path:"/account/changepassword",component:Et}),s.a.createElement(B.a,{exact:!0,path:"/account/verifyemail",component:Nt}),s.a.createElement(P.a,{to:"/account"}))}}]),t}(s.a.Component),kt=Object(c.b)(null,function(e){return{dispatch:e}})(Object(ae.a)(jt)),Ot=a(186),Lt=(a(726),a(333)),St=a.n(Lt),xt=a(334),Ct=a.n(xt),Dt=(a(734),a(735),16),Tt=[40.37937457190185,49.848964512348175];window.navigator&&window.navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){Tt=[e.coords.latitude,e.coords.longitude]});var Mt,_t,It=[],At=[],zt={zoomControl:!0,zoom:13,maxZoom:18,minZoom:2,doubleClickZoom:!0,scrollWheelZoom:!0,dragging:!0,editable:!0,animate:!0,legends:!0,infoControl:!0,easeLinearity:10,attributionControl:!0};ue.a.drawLocal={draw:Object(m.a)({},ue.a.drawLocal.draw,{toolbar:Object(m.a)({},ue.a.drawLocal.draw.toolbar,{actions:!1,finish:!1,undo:!1,buttons:!1})}),edit:Object(m.a)({},ue.a.drawLocal.edit,{toolbar:Object(m.a)({},ue.a.drawLocal.edit.toolbar,{actions:Object(m.a)({},ue.a.drawLocal.edit.toolbar.actions,{save:{title:L.get("Save"),text:L.get("Save")},cancel:{title:L.get("Cancel"),text:L.get("Cancel")},clearAll:{title:L.get("ClearAll"),text:L.get("ClearAll")}}),buttons:{edit:L.get("EditLayers"),editDisabled:!1,remove:L.get("DeleteLayers"),removeDisabled:!1}}),handlers:{edit:{tooltip:!1},remove:{tooltip:!1}}})};var Bt=W.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3});function Pt(e){for(var t in e)console.log(e[t])}var Gt=function(e){function t(e){var a;Object(k.a)(this,t),ot=!1,a=Object(M.a)(this,Object(_.a)(t).call(this,e));var n=new Date,s=new Date(Ie()().add(1,"days")),o=Ie()().format("HH:mm"),i=St.a.parse(a.props.history.location.search);return i.dateFrom&&(n=new Date(i.dateFrom)),i.dateTo&&(s=new Date(i.dateTo)),i.time&&(o=i.time),a.state={isLoading:!0,modal:null,items:[],objects:[],routes:[],object_id:!1,object:!1,event:!1,dateFrom:n,dateTo:s,timeFrom:"00:00",timeTo:o,times:[],map:{center:Tt,zoom:Dt,layers:[]}},a.showModal=a.showModal.bind(Object(R.a)(Object(R.a)(a))),a.hideModal=a.hideModal.bind(Object(R.a)(Object(R.a)(a))),a.onSubmit=a.onSubmit.bind(Object(R.a)(Object(R.a)(a))),a.createMarker=a.createMarker.bind(Object(R.a)(Object(R.a)(a))),a.selectDateFrom=a.selectDateFrom.bind(Object(R.a)(Object(R.a)(a))),a.selectDateTo=a.selectDateTo.bind(Object(R.a)(Object(R.a)(a))),a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"toggleSidebar",value:function(){this.props.dispatch({type:"TOGGLE_SIDEBAR"}),setTimeout(function(){ot.invalidateSize()},200)}},{key:"changeType",value:function(e){this.state.type!==e&&this.setState({type:e})}},{key:"loadObjects",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,D.get("objects.list",{limit:0},function(e){"success"===e.status&&t.setState({objects:e.data})});case 3:return e.abrupt("return",t.state.objects);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getObject",value:function(){var e=Object(j.a)(N.a.mark(function e(t){var a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,e.next=3,D.get("objects.info",{id:t},function(e){"success"===e.status&&a.setState({object:e.data})});case 3:return e.abrupt("return",a.state.object);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"selectDateFrom",value:function(e){this.setState({dateFrom:e}),Pt([e])}},{key:"selectDateTo",value:function(e){this.setState({dateTo:e}),Pt([e])}},{key:"selectTimeFrom",value:function(e){this.setState({timeFrom:e}),Pt([e])}},{key:"selectTimeTo",value:function(e){this.setState({timeTo:e}),Pt([e])}},{key:"onSubmit",value:function(){var e=this;e.refs;e.removeLayers(),It=[],At=[],[],e.setState({isLoading:!0,items:[]});var t=Ie()(this.state.dateFrom).format("YYYY-MM-DD"),a=Ie()(this.state.dateTo).format("YYYY-MM-DD"),n=this.state.timeFrom,s=this.state.timeTo;D.get("history.routes",{id:this.state.object_id,datefrom:t+" "+n+":00",dateto:a+" "+s+":00",skip:0,limit:0},function(t){e.setState({isLoading:!1}),"success"===t.status?(e.setState({items:t.data}),setTimeout(function(){e.removeLayers(),e.initMarkers(),e.fitBounds()},0)):Bt({type:"error",title:t.description})})}},{key:"showModal",value:function(e){this.setState({modal:e})}},{key:"hideModal",value:function(){this.setState({modal:null})}},{key:"reload",value:function(){this.loadObjects(),this.removeLayers()}},{key:"createMarker",value:function(e,t){var a={icon:ue.a.divIcon({html:'<svg class="leaflet-icon"><use xlink:href="#direction"></use></svg>'}),rotationAngle:.8*t.angle},n=new ue.a.Marker(e,a);n.bindPopup(t.title),Mt.addLayer(n).addTo(ot)}},{key:"removeLayers",value:function(){Mt.clearLayers()}},{key:"initMarkers",value:function(){var e=this.state.items,t=[],a=[];Ct()({hue:"random",luminosity:"light",count:50});e.map(function(e,n){if("route"===e.type){if(e.tracks&&e.tracks.length){var s=e.tracks.map(function(e){return[e.latitude,e.longitude]});t.push(s),a.push(s),At[e.id]=ue.a.polyline(s,{weight:5,color:"#228dff"}),At[e.id].bindPopup("Date: "+e.starttime+"<br/>Duration: "+e.duration+"<br/>Distance: "+e.distance+"<br/>"),Mt.addLayer(At[e.id]).addTo(ot),At[e.id].on("popupopen",function(){At[e.id].setStyle({color:"#1cd600"})}),At[e.id].on("popupclose",function(){At[e.id].setStyle({color:"#228dff"})});var o=[];e.tracks.map(function(e,t){o[t]=e})}}else if("point"===e.type&&e.coords.latitude&&e.coords.longitude){var i=[e.coords.latitude,e.coords.longitude];t.push(i),a.push(i),It[e.id]=ue.a.marker(i,{icon:ue.a.icon({iconUrl:"/assets/images/marker.svg",iconSize:[20,30],iconAnchor:[10,30],popupAnchor:[0,-15]})}),It[e.id].bindPopup("Date: "+e.starttime+"<br/>Duration: "+e.duration+"<br/>Distance: "+e.distance+"<br/>"),It[e.id].on("popupopen",function(){he()(".custom-popup-close").click(function(){It[e.id].closePopup()})}),Mt.addLayer(It[e.id]).addTo(ot)}}),a&&ot.fitBounds(a)}},{key:"fitBounds",value:function(){var e=this.state.items,t=[];e.map(function(e){var a=[e.latitude,e.longitude];t.push(a)}),t.length}},{key:"setEvent",value:function(e){if(this.state.event===e)return!1;this.setState({event:e}),"point"===e.type?(It[e.id]&&It[e.id].openPopup(),ot.fitBounds([[e.coords.latitude,e.coords.longitude]])):"route"===e.type&&(At[e.id]&&At[e.id].openPopup(),ot.fitBounds(At[e.id].getBounds()))}},{key:"componentDidMount",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t,a,n,s;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({isLoading:!0}),!this.props.match.params.object_id){e.next=6;break}return e.next=4,this.getObject(this.props.match.params.object_id);case 4:e.sent&&this.setState({object_id:this.props.match.params.object_id});case 6:return e.next=8,this.loadObjects();case 8:for((t=e.sent)&&this.setState({isLoading:!1,objects:t}),ot=ue.a.map("map",zt).setView(this.state.map.center,this.state.map.zoom),ue.a.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(ot),Mt=new ue.a.LayerGroup,ot.addLayer(Mt),_t=new ue.a.markerClusterGroup,ot.addLayer(_t),he()(window).on("resize",function(){setTimeout(function(){},100)}),15,(a=[]).push(n="00:00"),s=0;s<95;s++)n=Ie()(n,"HH:mm").add(15,"minutes").format("HH:mm"),a.push(n);this.setState({times:a});case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,n=t.objects;return s.a.createElement("div",{className:U()("app-container",{"show-sidebar":this.props.showSidebar})},s.a.createElement(oe,{title:L.get("Objects"),controller:"tracks"}),s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"sidebar-wrapper"},s.a.createElement("div",{className:"sidebar-body p-3",style:{height:"100%"}},!!a&&s.a.createElement("div",{className:"backdrop wziokH"},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("form",{action:"",onSubmit:function(){return e.onSubmit()}},s.a.createElement("div",{className:"form-group row no-gutters mb-3"},s.a.createElement("label",{className:"col-4"},L.get("Object"),":"),s.a.createElement("div",{className:"col-8"},s.a.createElement("select",{className:"form-control custom-select",ref:"object_id",value:this.state.object_id,onChange:function(t){return e.setState({object_id:t.target.value})}},s.a.createElement("option",{value:""},"---"),n&&n.map(function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.title)})))),s.a.createElement("div",{className:"form-group row no-gutters mb-3"},s.a.createElement("label",{className:"col-4"},L.get("DateFrom"),":"),s.a.createElement("div",{className:"col-8 row no-gutters flex-nowrap"},s.a.createElement("div",{className:"col"},s.a.createElement(Ot.a,{className:"form-control",selected:this.state.dateFrom,onChange:this.selectDateFrom,popperPlacement:"top-start",dateFormat:"YYYY-MM-dd"})),s.a.createElement("div",{className:"col-auto pl-3"},s.a.createElement("select",{style:{width:"84px"},className:"form-control custom-select",defaultValue:this.state.timeFrom,onChange:function(t){return e.setState({timeFrom:t.target.value})}},this.state.times.map(function(e,t){return s.a.createElement("option",{key:t,value:e},e)}))))),s.a.createElement("div",{className:"form-group row no-gutters mb-3"},s.a.createElement("label",{className:"col-4"},L.get("DateTo"),":"),s.a.createElement("div",{className:"col-8 row no-gutters flex-nowrap"},s.a.createElement("div",{className:"col"},s.a.createElement(Ot.a,{className:"form-control",selected:this.state.dateTo,onChange:this.selectDateTo,popperPlacement:"top-start",dateFormat:"YYYY-MM-dd"})),s.a.createElement("div",{className:"col-auto pl-3"},s.a.createElement("select",{style:{width:"84px"},className:"form-control custom-select",defaultValue:this.state.timeTo,onChange:function(t){return e.setState({timeTo:t.target.value})}},this.state.times.map(function(e,t){return s.a.createElement("option",{key:t,value:e},e)}))))),s.a.createElement("div",{className:"form-group row no-gutters mb-3"},s.a.createElement("label",{className:"col-4"}),s.a.createElement("div",{className:"col-8"},s.a.createElement("button",{className:"btn btn-success btn-block",type:"button",onClick:function(){return e.onSubmit()}},L.get("Build"))))),s.a.createElement("div",{className:"list ZKfHhX"},this.state.items&&this.state.items.map(function(t,a){return"point"===t.type?s.a.createElement("div",{key:a,className:U()("item",{active:e.state.event===t}),onClick:function(){return e.setEvent(t)}},s.a.createElement("div",{className:"column col-1"},"parking"===t.action?s.a.createElement("span",{className:"letter-circle",title:t.action},"P"):s.a.createElement("span",{className:"letter-circle green",title:t.action},"D")),s.a.createElement("div",{className:"column col-7"},t.starttime),s.a.createElement("div",{className:"column col-4 text-right"},t.duration)):"route"===t.type?s.a.createElement("div",{key:a,className:U()("item",{active:e.state.event===t}),onClick:function(){return e.setEvent(t)}},s.a.createElement("div",{className:"column col-1"},"move"===t.action?s.a.createElement("span",{className:"letter-circle grey",title:t.action},"M"):s.a.createElement("span",{className:"letter-circle",title:t.action},"E")),s.a.createElement("div",{className:"column col-7"},t.starttime),s.a.createElement("div",{className:"column col-4 text-right"},t.duration)):void 0})))),s.a.createElement("span",{className:"btn-toggler",onClick:function(){return e.toggleSidebar()}},s.a.createElement("i",{className:"feather feather-chevrons-".concat(this.props.showSidebar?"left":"right")}))),s.a.createElement("div",{className:"main"},!!a&&s.a.createElement("div",{className:"backdrop wziokH",style:{height:"calc(100vh - 60px)",zIndex:999}},s.a.createElement("div",{className:"loader gVt9Xk"})),s.a.createElement("div",{className:"map-wrapper"},s.a.createElement("div",{id:"map"}))))}}]),t}(s.a.Component),Vt=Object(c.b)(function(e){return{sidebarLoader:e.globals.sidebarLoader,showSidebar:e.globals.showSidebar,mainLoader:e.globals.mainLoader}},function(e){return{dispatch:e}})(Object(ae.a)(Gt)),Ht=function(e){function t(){return Object(k.a)(this,t),Object(M.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(I.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){"POP"===this.props.history.action&&this.props.dispatch({type:"SET_HEADER_ACTIVE_LINK_ID",value:"tracks"})}},{key:"render",value:function(){return s.a.createElement(z.a,null,s.a.createElement(B.a,{exact:!0,path:"/tracks",component:Vt}),s.a.createElement(B.a,{exact:!0,path:"/tracks/:object_id",component:Vt}),s.a.createElement(P.a,{to:"/tracks"}))}}]),t}(s.a.Component),Ut=Object(c.b)(null,function(e){return{dispatch:e}})(Object(ae.a)(Ht)),Rt=x.a.load("_token"),Yt=x.a.load("_lang"),Ft=x.a.load("_sid"),Wt=new Date;Wt.setDate(Wt.getDate()+365),Ft||(Ft=V()(11111111111+88888888888*Math.random()),x.a.save("_sid",Ft,{path:"/",expires:Wt})),Yt||(Yt="ru",x.a.save("_lang",Yt,{path:"/",expires:Wt}));var Zt=function(e){function t(e){var a;return Object(k.a)(this,t),(a=Object(M.a)(this,Object(_.a)(t).call(this,e))).state={isLoading:!0},a}return Object(I.a)(t,e),Object(O.a)(t,[{key:"initApp",value:function(){var e=Object(j.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,D.get("translations",{token:Rt,sid:Ft},function(e){"success"===e.status&&L.setData(e.data)});case 3:D.get("settings",{token:Rt,sid:Ft},function(e){"success"===e.status&&(t.props.dispatch({type:"SET_SETTINGS",value:e}),e.account_data&&t.props.dispatch({type:"SET_USER_DATA",value:e.account_data}),setTimeout(function(){return t.props.dispatch({type:"SET_APP_LOADER",value:!1})},t.props.auth?1800:900))},function(){setTimeout(function(){return t.props.dispatch({type:"SET_APP_LOADER",value:!1})},t.props.auth?1800:900)});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;this.interval||(this.interval=setTimeout(function(){return e.initApp()})),this.interval=setInterval(function(){return e.initApp()},1e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"shouldComponentUpdate",value:function(e){return e.appLoader!==this.props.appLoader}},{key:"render",value:function(){return s.a.createElement("div",null,this.props.appLoader?s.a.createElement("div",{className:"loader-jcNItk-container"},s.a.createElement("div",{className:"loader-qrjiL2"},s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null))):s.a.createElement(A.a,null,this.props.auth?s.a.createElement(z.a,null,s.a.createElement(B.a,{path:"/objects",component:Je}),s.a.createElement(B.a,{path:"/groups",component:dt}),s.a.createElement(B.a,{path:"/tracks",component:Ut}),s.a.createElement(B.a,{path:"/geo-objects",component:Te}),s.a.createElement(B.a,{path:"/account",component:kt}),s.a.createElement(P.a,{to:"/groups"})):s.a.createElement(z.a,null,s.a.createElement(B.a,{exact:!0,path:"/login",component:J}),s.a.createElement(B.a,{exact:!0,path:"/register",component:K}),s.a.createElement(B.a,{exact:!0,path:"/lostpassword",component:te}),s.a.createElement(P.a,{to:"/login"}))))}}]),t}(s.a.Component),Xt=Object(c.b)(function(e){return{appLoader:e.globals.appLoader,auth:e.user.auth}},function(e){return{dispatch:e}})(Zt);i.a.render(s.a.createElement(c.a,{store:y},s.a.createElement(Xt,null)),document.getElementById("root"))},77:function(e,t,a){}},[[337,2,1]]]);
//# sourceMappingURL=main.6d5b6d51.chunk.js.map